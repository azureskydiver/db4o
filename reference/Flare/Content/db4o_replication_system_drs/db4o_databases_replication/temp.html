<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Simple Example	<link href="../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Simple Example</h1>
<p>The following example does a simple replication from a
handheld database to the desktop database:</p>

<span name="cs_wiki_filter" csw_filters="java">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">ReplicationExample.java: <span class="fscMemberName">replicate</span></span></div><div class="fscCode"><pre ID="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Open_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Closed_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Closed_Text').style.display='inline';"/><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Closed_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Open_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> replicate()</span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_30_699_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer desktop</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(configureReplication(), DTFILENAME);
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer handheld</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(configureReplication(), HHFILENAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;">     Setup a replication session</span><span style="color: #008000;">
</span><span style="color: #008080;">05</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    ReplicationSession replication </span><span style="color: #000000;">=</span><span style="color: #000000;"> Replication.begin(handheld, desktop);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Open_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Closed_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Closed_Text').style.display='inline';"/><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Closed_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Open_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Open_Text').style.display='inline';"/>    </span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_306_467_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * There is no need to replicate all the objects each time. 
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * objectsChangedSinceLastReplication methods gives us 
</span><span style="color: #008080;">10</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>     * a list of modified objects
</span><span style="color: #008080;">11</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>     </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectSet changed </span><span style="color: #000000;">=</span><span style="color: #000000;">  replication.providerA().objectsChangedSinceLastReplication();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Open_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Closed_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Closed_Text').style.display='inline';"/><img id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Closed_Text').style.display='none'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Open_Image').style.display='inline'; document.getElementById('....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (changed.hasNext()) </span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....ReplicationJava.ZipsReplicationExample.Java_ReplicationExample.Java_Replicate_162_73_583_630_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      replication.replicate(changed.next());
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    replication.commit();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    handheld.close();
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    desktop.close();
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">ReplicationExample.cs: <span class="fscMemberName">Replicate</span></span></div><div class="fscCode"><pre ID="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> Replicate()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Open_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Closed_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Closed_Text').style.display='inline';"/><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Closed_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Open_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Open_Text').style.display='inline';"/>        </span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_39_944_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectContainer desktop </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(ConfigureReplication(), DtFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectContainer handheld </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(ConfigureReplication(), HhFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IReplicationSession replication </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4objects.Drs.Replication.Begin(handheld, desktop);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Open_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Closed_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Closed_Text').style.display='inline';"/><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Closed_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Open_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Open_Text').style.display='inline';"/>            </span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_360_561_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>             * There is no need to replicate all the objects each time. 
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>             * ObjectsChangedSinceLastReplication methods gives us 
</span><span style="color: #008080;">10</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>             * a list of modified objects
</span><span style="color: #008080;">11</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>             </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectSet changed </span><span style="color: #000000;">=</span><span style="color: #000000;"> replication.ProviderA().ObjectsChangedSinceLastReplication();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">//</span><span style="color: #008000;">Iterate through changed objects, replicate them</span><span style="color: #008000;">
</span><span style="color: #008080;">14</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (changed.HasNext())
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Open_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Closed_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Closed_Text').style.display='inline';"/><img id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Closed_Text').style.display='none'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Open_Image').style.display='inline'; document.getElementById('....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Open_Text').style.display='inline';"/>            </span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....ReplicationCS.ZipsReplicationExample.Cs_ReplicationExample.Cs_Replicate_299_69_769_841_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                replication.Replicate(changed .Next ());
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            replication.Commit();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            handheld.Close();
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            desktop.Close();
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">ReplicationExample.vb: <span class="fscMemberName">Replicate</span></span></div><div class="fscCode"><pre ID="....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Open_Text').style.display='none'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Closed_Image').style.display='inline'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Closed_Text').style.display='inline';"/><img id="....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Closed_Text').style.display='none'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Open_Image').style.display='inline'; document.getElementById('....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub Replicate()</span><span id="....ReplicationVB.ZipsReplicationExample.Vb_ReplicationExample.Vb_Replicate_432_69_14_872_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> Replicate()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> desktop </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(ConfigureReplication(), DtFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> handheld </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(ConfigureReplication(), HhFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> replic </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IReplicationSession </span><span style="color: #000000;">=</span><span style="color: #000000;"> Replication.Begin(handheld, desktop) </span><span style="color: #008000;">'
</span><span style="color: #008080;">05</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #008000;">'</span><span style="color: #008000;"> There is no need to replicate all the objects each time. </span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #008000;">'</span><span style="color: #008000;"> ObjectsChangedSinceLastReplication methods gives us </span><span style="color: #008000;">
</span><span style="color: #008080;">07</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #008000;">'</span><span style="color: #008000;"> a list of modified objects</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> changed </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> replic.ProviderA().ObjectsChangedSinceLastReplication()
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">'</span><span style="color: #008000;">Iterate through the changed objects, replicate them</span><span style="color: #008000;">
</span><span style="color: #008080;">10</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #0000FF;">While</span><span style="color: #000000;"> changed.HasNext()
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                replic.Replicate(changed.Next())
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">While</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            replic.Commit()
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            handheld.Close()
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            desktop.Close()
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span>
We start by opening two ObjectContainers. The next line
creates the ReplicationSession. This object contains all of the
replication-related logic.

<p>After creating the session, there is an interesting line:</p>

<span name="cs_wiki_filter" csw_filters="java">

<p>Java:</p>

<p><code>ObjectSet changed =
replication.providerA().objectsChangedSinceLastReplication();
</code></p>

</span>

<span name="cs_wiki_filter" csw_filters="cs">

<p>C#:</p>

<p><code>IObjectSet changed =
replication.ProviderA().ObjectsChangedSinceLastReplication();
</code></p>

</span>

<span name="cs_wiki_filter" csw_filters="vb">

<p>VB:</p>

<p><code>Dim changed As IObjectSet =
replication.ProviderA().ObjectsChangedSinceLastReplication()
</code></p>

</span>
This line of code will get the provider associated with the
first of our sources (the handheld ObjectContainer in this case). Then it
finds all of the objects that have been updated or created. The
new/modified objects will be returned in an enumerable ObjectSet. 
<p>
After that comes a simple loop where the resulting objects are replicated one
at a time. 
The <code>replication.commit()</code> call at the end is important. This line
will save all of the changes we have made, and end any needed transactions.
Forgetting to make this call will result in your replication changes being
discarded when your application ends, or your ObjectContainers are closed. 
The <code>#commit()</code> calls also mark all objects as replicated.
Therefore, changed/new objects that are not replicated in this session
will be marked as replicated.      </p>


</div>
    </div>
    
  </body></html>
