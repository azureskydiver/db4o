<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="7" MadCap:lastHeight="1533" MadCap:lastWidth="1017" MadCap:conditions="Primary.Java">
    <head><title>Servlets	<link href="../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" /><script type="text/javascript" src="../Resources/Code/prettify.js"></script></title>
    </head>
    <body onload="prettyPrint()">
        <div class="CommonContent">
            <div class="CommonContentArea">
                <h1>Servlets</h1>
                <p><font color="#990000">&#160;</font>
                </p>
                <p MadCap:conditions="Primary.Java">
                    <p>Running db4o as the persistence layer of a Java web application is easy. There is no installation procedure - db4o is just another library in your application. There are only two issues that make web applications distinct from standalone programs from a db4o point of view. One is the more complex classloader environment - db4o needs to know itself (of course) and the classes to be persisted. Please refer to the <a href="classloader_issues.htm" class="wikiLink">classloader</a> chapter for more information.</p>
                    <p>The other issue is configuring, starting and shutting down the db4o server correctly. This can be done at the servlet API layer or within the web application framework you are using.</p>
                    <p>On the servlet API layer, you could bind db4o server handling to the servlet context via an appropriate listener. A very basic sketch might look like this:</p>
                    <MadCap:snippetBlock src="../Resources/Snippets/Servlets/Db4oServletContextListener.java/Db4oServletContextListener.java.flsnp" />
                    <p>This listener just has to be registered in the web.xml.</p>
                    <MadCap:snippetBlock src="../Resources/Snippets/Servlets/web.xml/web.xml.flsnp" />
                    <p>Now db4o should be available to your application classes.</p>
                    <p><code>ObjectServer server=(ObjectServer)context.getAttribute("db4oServer")</code>
                    </p>
                    <p>A more complex and 'old school' example without using context listeners comes with the samples section of the db4o3 distribution that's still available from our web site.</p>
                    <p>However, We strongly suggest that you use the features provided by your framework and that you consider not exposing db4o directly to your application logic. (There is nothing db4o-specific about these recommendentations, we would vote for this in the presence of any persistence layer.)</p>
                </p>
                <p MadCap:conditions="Primary:java" />
            </div>
        </div>
        <p MadCap:conditions="Primary.Online">Download example code:</p>
        <p MadCap:conditions="Primary.Online">
            <MadCap:conditionalText MadCap:conditions="Primary.Java"><a href="servletsjava.zip">Java </a>
            </MadCap:conditionalText>
        </p>
    </body>
</html>