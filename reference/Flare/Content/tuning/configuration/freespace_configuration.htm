<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Freespace Configuration	<link href="../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
        <h1>Freespace Configuration</h1><p>When objects are
updated or deleted, the space previously occupied in the database file
is marked as "free". Freespace management system takes care of this space by maintaining two lists in
RAM, sorted by address and by size. The following configuration methods allow to tune the freespace management system to help you optimize your system:</p>
<p MadCap:conditions="Primary.Java">
<p>Java:  </p>
<p><code>public void discardSmallerThan(int byteCount);</code> </p>
</p><p MadCap:conditions="Primary:java" />
<p MadCap:conditions="Primary.Print">
<p>.NET:  </p>
<p><code>public void DiscardSmallerThan(int byteCount);</code> 
</p>
</p><p MadCap:conditions="Primary:net" />
<p>
<p>Configures the minimum size of free space slots in the database file that are to 
be reused. </p>

<p>2 extremes for byteCount value:</p>

<ul>
<li>Integer.MAX_VALUE/Int32.MaxValue - discard all free slots for the best possible
startup time. The downside: database files will necessarily grow faster</li>
<li>0
- default setting, all freespace is reused. The downside: increased
memory consumption and performance loss for maintenance of freespace
lists in RAM </li>
</ul></p>
<p MadCap:conditions="Primary.Java">
<p>Java:  </p>
<p><code>public void freespaceFiller(FreespaceFiller freespaceFiller);</code> </p>
</p><p MadCap:conditions="Primary:java" />
<p MadCap:conditions="Primary.Print">
<p>.NET:  </p>
<p><code>public void FreespaceFiller(IFreespaceFiller freespaceFiller);</code> 
</p>
</p><p MadCap:conditions="Primary:net" />

<p>This method allows to specify a way to overwrite the freed space in the database. This may be desirable when the information needs to be reliably erased. A <a href="freespace_configuration/freespacefiller_example.htm" class="wikiLink">custom FreespaceFiller</a> implementation can be created. For an example of db4o implementation of FreespaceFiller you can have a look at XByteFreespaceFiller in the db4o source code (IoAdaptedObjectContainer class). XByteFreespaceFiller overwrites the free space with "XXXX" symbols and is switched on by rebuilding db4o core with debug = true in Deploy class.  </p>
<p>Note, that using freespace filler will slow down IO operations on the database.</p>
     
<p>The following settings allow to select how the freespace information will be kept: </p>
<p MadCap:conditions="Primary.Java">
<p>Java:  </p>
<p><code>public void useBTreeSystem();</code></p>
<p><code>public void useRamSystem();</code></p>
</p><p MadCap:conditions="Primary:java" />
<p><p MadCap:conditions="Primary.Print"> </p>
<p>.NET:  </p>
<p><code>public void UseBTreeSystem();</code></p>
<p><code>public void UseRamSystem();</code></p>
<p></p><p MadCap:conditions="Primary:net" /></p>

<p>When BTree system is used to keep freespace information, the performance is worse as the information is written to disk at each commit, but the memory consumption is lower. With the RAM system, all freespace information is kept in RAM, which allows the best performance, however this information is lost on abnormal system termination.  </p>
    
  </body></html>
