<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Enable Field Indexes	<link href="../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
        <h1>Enable Field Indexes</h1>


<p>For class Car with field "pilot":</p>

<p MadCap:conditions="Primary.Java,Primary.All languages">

<p>Java: </p>
<p><code>Db4o.configure().objectClass(Car.class).objectField("pilot").indexed(true)</code></p>

</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<p>c#:   </p>
<p><code>Db4oFactory.Configure().ObjectClass(typeof(Car)).ObjectField("pilot").Indexed(true)</code></p>

</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<p>VB:   </p>
<p><code>Db4oFactory.Configure().ObjectClass(GetType(Car)).ObjectField("pilot").Indexed(true)</code></p>

</p><p MadCap:conditions="Primary:vb" />

<a name="Advantage"></a><h2>Advantage</h2>
<p>The fastest way to improve the performance of your queries is to enable indexing on some of your class's key fields. You can read how to do it in <a href="../indexing.htm"  >Indexing</a> chapter of this documentation.</p>

<p>
Further step of index tuning is to optimize indexes for Class.Field1.Field2 access. What will give us the best performance:</p>

<ul>
<li>
index on Field1;</li>

<li>index on Field2;</li>

<li>index on both fields?</li>
</ul>

<p>To find the answer let's consider classes Car and Pilot from the previous chapters. In order to see indexing influence we will put 10000 new cars in our storage (note that for db4o version &gt; 5.6 the amount of objects  should be much more to see the differences in execution time due to BTree based index optimized for big amounts of data ):</p>

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/fillUpDB.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/FillUpDB.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/FillUpDB.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/addCar.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/AddCar.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/AddCar.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p>Now we have lots of similar cars differing only in the amount of pilots' points - that will be our constraint for the query.</p>

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/noIndex.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/NoIndex.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/NoIndex.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p>You can check execution time on your workstation using interactive version of this tutorial.</p>

<p>Let's create index for pilots and their points and test the same query again:</p>

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/fullIndex.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/FullIndex.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/FullIndex.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p>That result is considerably better and proves the power of indexing.</p>

<p>
But do we really need 2 indexes? Will single pilot or points index suffice? Let's test this as well:</p>

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/pilotIndex.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/PilotIndex.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/PilotIndex.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p MadCap:conditions="Primary.Java,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.java/pointsIndex.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.cs/PointsIndex.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET,Primary.All languages">

<MadCap:snippetBlock src="../../Resources/Snippets/Enable Field Indexes/IndexedExample.vb/PointsIndex.flsnp" />
</p><p MadCap:conditions="Primary:vb" />

<p>Single index does not increase query performance on second level fields.</p>

<p>
To maximize retrieval performance on encapsulated fields of different levels of enclosure</p>

<p>Class.Field1.Field2.Field3(.FieldN)</p>

<p>indexes for each field level should be created:</p>

<p>Class.Field1.Indexed(true) </p>

<p>Field1Class.Field2.Indexed(true)</p>

<p>Field2Class.Field3.Indexed(true)</p>

<p>. . .</p>

<p>Field(N-1)Class.FieldN.Indexed(true)</p>
<a name="Alternate Strategies"></a><h2>Alternate Strategies</h2>
<p>Field indexes dramatically improve query performance but they may considerably reduce storage and update performance. The best way to decide where to put the indexes is to test them on completed application with typical data load.</p>    
</body></html>