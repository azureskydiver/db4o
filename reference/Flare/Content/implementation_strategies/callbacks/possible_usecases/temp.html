<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Referential Integrity	<link href="../../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Referential Integrity</h1><p>Db4o does not have a built-in referential integrity checking
mechanism. Luckily EventRegistry gives you access to all the necessary events
to implement it. You will just need to trigger validation on create, update or
delete and cancel the action if the integrity is going to be broken.</p>

<p>For example, if Car object is referencing Pilot and the
referenced object should exist, this can be ensured with the following handler
in deleting() event:</p>

<span name="cs_wiki_filter" csw_filters="java">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">CallbacksExample.java: <span class="fscMemberName">testIntegrityCheck</span></span></div><div class="fscCode"><pre ID="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> testIntegrityCheck() </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_41_1403_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    fillDB();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">final</span><span style="color: #000000;"> ObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.openFile(DB4O_FILE_NAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_136_1364_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      EventRegistry registry </span><span style="color: #000000;">=</span><span style="color: #000000;"> EventRegistryFactory
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          .forObjectContainer(container);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> register an event handler, which will stop deleting a pilot when
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> it is referenced from a car</span><span style="color: #008000;">
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Open_Text').style.display='inline';"/></span><span style="color: #000000;">      registry.deleting().addListener(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> EventListener4() </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_385_983_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> onEvent(Event4 e, EventArgs args) </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_437_978_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          CancellableObjectEventArgs cancellableArgs </span><span style="color: #000000;">=</span><span style="color: #000000;"> ((CancellableObjectEventArgs) args);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Object obj </span><span style="color: #000000;">=</span><span style="color: #000000;"> cancellableArgs.object();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Open_Text').style.display='inline';"/>          </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (obj </span><span style="color: #0000FF;">instanceof</span><span style="color: #000000;"> Pilot) </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_601_972_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Query q </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.query();
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            q.constrain(Car.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            q.descend(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">pilot</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).constrain(obj);
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            ObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.execute();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Open_Text').style.display='inline';"/>            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (result.size() </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #000000;">0</span><span style="color: #000000;">) </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_776_965_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              System.out
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                  .println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Object </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                      </span><span style="color: #000000;">+</span><span style="color: #000000;"> (Pilot) obj
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                      </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #000000;">&quot;</span><span style="color: #000000;"> can't be deleted as object container has references to it</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              cancellableArgs.cancel();
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>          }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">);
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> check the contents of the database</span><span style="color: #008000;">
</span><span style="color: #008080;">30</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">      List result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.queryByExample(</span><span style="color: #0000FF;">null</span><span style="color: #000000;">);
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      listResult(result);
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> try to delete all the pilots</span><span style="color: #008000;">
</span><span style="color: #008080;">34</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">      List</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> pilots </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.query(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">35</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">for</span><span style="color: #000000;"> (Pilot p: pilots) </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1215_1246_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">36</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.delete(p);
</span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">38</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> check if any of the objects were deleted</span><span style="color: #008000;">
</span><span style="color: #008080;">39</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">      result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.queryByExample(</span><span style="color: #0000FF;">null</span><span style="color: #000000;">);
</span><span style="color: #008080;">40</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      listResult(result);
</span><span style="color: #008080;">41</span><span style="color: #000000;"><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Open_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Closed_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Closed_Text').style.display='inline';"/><img id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Closed_Text').style.display='none'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Open_Image').style.display='inline'; document.getElementById('....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Open_Text').style.display='inline';"/>    }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksJava.ZipsCallbacksExample.Java_CallbacksExample.Java_TestIntegrityCheck_519_78_1373_1400_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">42</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      container.close();
</span><span style="color: #008080;">43</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">44</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="cs">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">CallbacksExample.cs: <span class="fscMemberName">TestIntegrityCheck</span></span></div><div class="fscCode"><pre ID="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> TestIntegrityCheck()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Open_Text').style.display='inline';"/>        </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_49_939_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        FillContainer();
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> OpenContainer();
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_142_880_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                IEventRegistry registry </span><span style="color: #000000;">=</span><span style="color: #000000;"> EventRegistryFactory.ForObjectContainer(container);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #008000;">//</span><span style="color: #008000;"> register an event handler, which will stop Deleting a pilot when it is referenced from a car </span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">          registry.Deleting </span><span style="color: #000000;">+=</span><span style="color: #000000;"> OnDeleting; 
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #008000;">//</span><span style="color: #008000;"> check the contents of the database</span><span style="color: #008000;">
</span><span style="color: #008080;">11</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                IList result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.QueryByExample(</span><span style="color: #0000FF;">null</span><span style="color: #000000;">);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          ListResult(result);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #008000;">//</span><span style="color: #008000;"> try to delete all the pilots</span><span style="color: #008000;">
</span><span style="color: #008080;">15</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                IList</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> pilots </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">foreach</span><span style="color: #000000;"> (var p </span><span style="color: #0000FF;">in</span><span style="color: #000000;"> pilots)
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Open_Text').style.display='inline';"/>            </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_683_737_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    container.Delete(p);
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #008000;">//</span><span style="color: #008000;"> check if any of the objects were Deleted</span><span style="color: #008000;">
</span><span style="color: #008080;">21</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.QueryByExample(</span><span style="color: #0000FF;">null</span><span style="color: #000000;">);
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          ListResult(result);
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Open_Text').style.display='inline';"/>        }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_TestIntegrityCheck_661_74_889_932_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                CloseContainer();
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>      }</span></span></div></pre></div></div>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">CallbacksExample.cs: <span class="fscMemberName">OnDeleting</span></span></div><div class="fscCode"><pre ID="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> OnDeleting(</span><span style="color: #0000FF;">object</span><span style="color: #000000;"> sender, CancellableObjectEventArgs args)
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Open_Text').style.display='inline';"/>        </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_87_748_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Object obj </span><span style="color: #000000;">=</span><span style="color: #000000;"> args.Object;
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (obj </span><span style="color: #0000FF;">is</span><span style="color: #000000;"> Pilot)
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Open_Text').style.display='inline';"/>            </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_169_738_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> OpenContainer();
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">//</span><span style="color: #008000;"> search for the cars referencing the pilot object</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                IQuery q </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query();
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Constrain(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Car));
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Descend(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_pilot</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">).Constrain(obj);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (result.Count </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Open_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Closed_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Closed_Text').style.display='inline';"/><img id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Closed_Text').style.display='none'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Open_Image').style.display='inline'; document.getElementById('....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Open_Text').style.display='inline';"/>                </span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="....CallbacksCS.ZipsCallbacksExample.Cs_CallbacksExample.Cs_OnDeleting_739_66_544_724_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Object </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> (Pilot)obj </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;"> can't be Deleted as object container has references to it</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    args.Cancel();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>                }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

</span>

<span name="cs_wiki_filter" csw_filters="vb">


<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">CallbacksExample.vb: <span class="fscMemberName">TestIntegrityCheck</span></span></div><div class="fscCode"><pre ID="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Open_Text').style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Closed_Image').style.display='inline'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Closed_Text').style.display='inline';"/><img id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Closed_Text').style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Open_Image').style.display='inline'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub TestIntegrityCheck()</span><span id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_TestIntegrityCheck_871_74_15_1058_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> TestIntegrityCheck()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            FillContainer()
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> OpenContainer()
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> registry </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IEventRegistry </span><span style="color: #000000;">=</span><span style="color: #000000;"> EventRegistryFactory.ForObjectContainer(container)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> register an event handler, which will stop Deleting a pilot when it is referenced from a car </span><span style="color: #008000;">
</span><span style="color: #008080;">07</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">AddHandler</span><span style="color: #000000;"> registry.Deleting, </span><span style="color: #0000FF;">AddressOf</span><span style="color: #000000;"> OnDeleting
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> check the contents of the database</span><span style="color: #008000;">
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IList </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.QueryByExample(</span><span style="color: #0000FF;">Nothing</span><span style="color: #000000;">)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                ListResult(result)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> try to delete all the pilots</span><span style="color: #008000;">
</span><span style="color: #008080;">12</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilots </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IList(</span><span style="color: #0000FF;">Of</span><span style="color: #000000;"> Pilot) </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query(</span><span style="color: #0000FF;">Of</span><span style="color: #000000;"> Pilot)()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">For</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Each</span><span style="color: #000000;"> p </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #0000FF;">In</span><span style="color: #000000;"> pilots
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    container.Delete(p)
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Next</span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> check if any of the objects were Deleted</span><span style="color: #008000;">
</span><span style="color: #008080;">17</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                result </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.QueryByExample(</span><span style="color: #0000FF;">Nothing</span><span style="color: #000000;">)
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                ListResult(result)
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                CloseContainer()
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">CallbacksExample.vb: <span class="fscMemberName">OnDeleting</span></span></div><div class="fscCode"><pre ID="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Open_Text').style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Closed_Image').style.display='inline'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Closed_Text').style.display='inline';"/><img id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Closed_Text').style.display='none'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Open_Image').style.display='inline'; document.getElementById('....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub OnDeleting()</span><span id="....CallbacksVB.ZipsCallbacksExample.Vb_CallbacksExample.Vb_OnDeleting_949_66_15_781_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> OnDeleting(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> sender </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Object</span><span style="color: #000000;">, </span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> args </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> CancellableObjectEventArgs)
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Object</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> args.Object
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">If</span><span style="color: #000000;"> </span><span style="color: #0000FF;">TypeOf</span><span style="color: #000000;"> obj </span><span style="color: #0000FF;">Is</span><span style="color: #000000;"> Pilot </span><span style="color: #0000FF;">Then</span><span style="color: #000000;">
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> search for the cars referencing the pilot object</span><span style="color: #008000;">
</span><span style="color: #008080;">05</span><span style="color: #008000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> OpenContainer()
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> q </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IQuery </span><span style="color: #000000;">=</span><span style="color: #000000;"> container.Query
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Constrain(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Car))
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                q.Descend(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">_pilot</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">).Constrain(obj)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IList </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.Execute
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">If</span><span style="color: #000000;"> result.Count </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Then</span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Object </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(obj, Pilot).ToString() </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;"> can't be Deleted as object container has references to it</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    args.Cancel()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">If</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

</span><p>
You can also add handlers for creating() and updating()
events for a Car object to make sure that the pilot field is not null. 
</p><p>Note, that in client/server mode deleting event is only raised on the server side, therefore the code above can't be used and will throw an exception.  </p></div>
    </div>
    
  </body></html>
