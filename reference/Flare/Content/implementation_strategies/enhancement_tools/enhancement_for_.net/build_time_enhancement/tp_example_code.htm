<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>TP Example Code	<link href="../../../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>TP Example Code</h1><p><font color="#990000">This topic applies to .NET version only </font></p><p>Let's
look at Transparent Persistence example. We will use <a href="sensorpanel.html" class="wikiLink">SensorPanel</a> class from <a href="../../../../object_lifecycle.html" class="wikiLink">Activation</a>
example, which represents a simple linked list.</p><p>First of all we must configure the database to use TP:</p><p MadCap:conditions="Primary..NET,Primary.c#"><MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.cs/ConfigureTP.flsnp" />p><p MadCap:conditions="Primary:cs" /><p MadCap:conditions="Primary..NET,Primary.VB.NET">
<MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.vb/ConfigureTP.flsnp" /></p><p MadCap:conditions="Primary:vb" /><p>Now, we should explicitly store the objects that we want to be persistent:</p><p MadCap:conditions="Primary..NET,Primary.c#">
<MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.cs/StoreSensorPanel.flsnp" /></p><p MadCap:conditions="Primary:cs" />
<p MadCap:conditions="Primary..NET,Primary.VB.NET">

<MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.vb/StoreSensorPanel.flsnp" />
</p><p MadCap:conditions="Primary:vb" />
<p>In order to test if TP actually works, we will select all the SensorPanel objects from the database, modify them and commit the transaction. If TP took place the objects will be modified in the database:</p><p MadCap:conditions="Primary..NET,Primary.c#">

<MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.cs/TestTransparentPersistence.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET">


<MadCap:snippetBlock src="../../../../Resources/Snippets/TP Example Code/TPExample.vb/TestTransparentPersistence.flsnp" />

</p><p MadCap:conditions="Primary:vb" />

<p>The code above is ready to accommodate TP, however TP is not possible now as SensorPanel does not implement IActivatable interface. In the <a href="example_enhancement.html" class="wikiLink">following chapter</a> we will learn how to enable TP for the project classes in the build time. </p><p>The
whole project code can be downloaded here: <a href="tp_example_code/tpexamplescs.zip.html" class="wikiLink">c#</a>  <a href="tp_example_code/tpexamplesvb.zip.html" class="wikiLink">vb</a></p><p>  </p>
</div>
    </div>
    
  <p>Download example code:</p>        <p></p></body></html>