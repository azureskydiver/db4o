<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Defragmentation Examples	<link href="../../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Defragmentation Examples</h1>

<p>The simplest defragmentation can look like this:</p>

<p MadCap:conditions="Primary.Java">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.java/simplestDefragment.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.cs/SimplestDefragment.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.vb/SimplestDefragment.flsnp" />
</p><p MadCap:conditions="Primary:vb" />



<p>The following example shows how to implement defragmentation
listener:</p>

<p MadCap:conditions="Primary.Java">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.java/defragmentWithListener.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.cs/DefragmentWithListener.flsnp" />iv class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.cs: <span class="fscMemberName">DefragmentListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> DefragmentListener : IDefragmentListener
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_58_247_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> IDefragmentListener.NotifyDefragmentInfo(DefragmentInfo info)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationCS.ZipsDefragmentExample.Cs_DefragmentExample.Cs_DefragmentListener_849_71_143_241_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">throw</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> System.Exception(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">The method or operation is not implemented.</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>  </p>

</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.vb/DefragmentWithListener.flsnp" />iv class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">DefragmentExample.vb: <span class="fscMemberName">DefragmentListener</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Class DefragmentListener</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_7_302_Open_Text"><span style="color: #0000FF;">Class</span><span style="color: #000000;"> DefragmentListener
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">Implements</span><span style="color: #000000;"> IDefragmentListener
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Open_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Closed_Image" src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub NotifyDefragmentInfo()</span><span id="ResourcesReferenceImplementation_StrategiesMaintenanceDefragmentDefragmentationVB.ZipsDefragmentExample.Vb_DefragmentExample.Vb_DefragmentListener_1072_71_80_288_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> NotifyDefragmentInfo(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> info </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> DefragmentInfo) </span><span style="color: #0000FF;">Implements</span><span style="color: #000000;"> IDefragmentListener.NotifyDefragmentInfo
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Throw</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> System.Exception(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">The method or operation is not implemented.</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span><span style="color: #000000;">
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    </span><span style="color: #0000FF;">End Class</span></span></div></pre></div></div>  </p>

</p><p MadCap:conditions="Primary:vb" />



<p>The following example will run defragment using
TreeIDMapping and commit frequency of 1 commit per 5000 objects. The backup
file will be deleted if already exists, only available to the classloader
classes will be left in the database (java version) and the file will be
upgraded if necessary.</p>

<p MadCap:conditions="Primary.Java">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.java/configuredDefragment.flsnp" />
</p><p MadCap:conditions="Primary:java" />

<p MadCap:conditions="Primary..NET,Primary.c#">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.cs/ConfiguredDefragment.flsnp" />
</p><p MadCap:conditions="Primary:cs" />

<p MadCap:conditions="Primary..NET,Primary.VB.NET">

<MadCap:snippetBlock src="../../../Resources/Snippets/Defragmentation Examples/DefragmentExample.vb/ConfiguredDefragment.flsnp" />
</p><p MadCap:conditions="Primary:vb" /></div>
    </div>
    
  <p>Download example code:</p>        <p></p></body></html>