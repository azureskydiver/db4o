<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="1161" MadCap:lastWidth="586" MadCap:ignoredWords="RandomAccessFileAdapter;randomAccessFileAdapter;NonFlushingIoAdapter;nonFlushingIoAdapter;CachedIoAdapter;cachedIoAdapter;disableCommitRecovery;DisableCommitRecovery;extObjectContainer;setSemaphore;getName;SetSemaphore;typeof;LOCK_;getID;GetID;getPilot;getSignature;idenity;car1;car2;car3;UUID;defragment;startsWith;getPoints;StartsWith;ExtentType;oql;AllPilots;OQLQuery;persistenceManager;newQuery;IList;IComparer;ObjectSet;IObjectSet;comparer;ExtObjectContainer;IExtObjectContainer;VB;pilot1;name1;name2;peekPersisted;isCached;JDO;WeakReferences;VM;ClientConfiguration;IClientConfiguration;BatchMessages;NO_OF_OBJECTS;maxBatchQueueSize;MaxBatchQueueSize;listResult;MessageRecipient;ObjectServer;openServer;ObjectNotStorableException;s;clientserverJava;ServerConfiguration;clientserverCS;cs;clientserverVB;vb;config;databaseFileName;int;NativeSocketFactory;socketFactory;OpenClient;hostName;IObjectServer;OpenServer;IConfiguration;INativeSocketFactory;IObjectContainer;genkey;SSLcert;storepass;SecureSocketFactory;IMessageSender;setMessageRecipient;SetMessageRecipient;IMessageRecipient;processMessage;ProcessMessage;ByVal;UpdateServer;waitMilliSeconds;releaseSemaphore;ReleaseSemaphore;monitorObject;semaphoreName;switchToFile;fileName;SwitchToFile;switchToMainFile;SwitchToMainFile;switchs;isAlive;IsAlive;replicateDeletions;ReplicateDeletions;GetType;g;ReplicationEvent;VersionNumbers;providerA;objectsChangedSinceLastReplication;ProviderA;ObjectsChangedSinceLastReplication;hbm;ProviderSignature;MySignature;PeerSignature;ReplicationProvider;HibernateReplicationProvider;ReplicationProviders;m;typed_id;pi2763;longPart;ObjectReference;className;typedId;Uuid;uuid;drs_providers;is_my_sig;t';f';drs_history;provider_id;PK;drs_objects;class_name;varchar;one_to_one;ReplicationConfigurator;SessionFactory;sessionFactory;buildSessionFactory;openSession;beginTransaction;createCriteria;AbstractDb4oTestCase;Db4oFixture;_fixture;AbstractSoloDb4oFixture;AbstractClientServerDb4oFixture;IDb4oFixture;IQuery;NewQuery;retrieveOnlyInstance;RetrieveOnlyInstance;countOccurences;CountOccurences;foreach;Visitor4;Foreach;IVisitor4;obj;deleteAll;DeleteAll;ReflectClass;reflectClass;indexField;fieldName;IndexField;Config;setUp;SetUp;db4oSetupBeforeStore;db4oSetupAfterStore;Db4oSetupBeforeStore;Db4oSetupAfterStore;runSoloAndClientServer;RunSoloAndClientServer;runSolo;RunSolo;runClientServer;RunClientServer;CodeBlock;Db4oUnit;ICodeBlock;isTrue;msg;IsTrue;bool;Msg;areEqual;AreEqual;FrameworkTestCase;runTestAndExpect;expFailures;RunTestAndExpect;ITest;GetConfig;storedType;runtimeType;tAlias;resolveRuntimeName;resolveStoredName;storedPattern;runtimePattern;aliasing;QueryStarted;QueryFinished;QueryEventArgs;ObjectEventArgs;CancellableObjectEventArgs;CommitEventArgs;client2;client1;WaitForCompletion;args;AddHandler;forObjectContainer;ForObjectContainer;OnCreated;createdEvent;onEvent;Event4;ABC0001DEF;MustInherit;CountedObject;IncrementedId;queryStarted;queryFinished;QueryStats;q;executionTime;activationCount;storedClass;Foo;classname;storedClasses;StoredClasses;getStoredFields;GetStoredFields;storedField;getParentStoredClass;GetParentStoredClass;reflectWith;Db4oFactory;ReflectWith;self_get;self_set;LoggingReflector;IoAdapter;MyEncryptionAdapter;Io;Db4oEnhancerMSBuildTask;SensorPanel;GetOptions;UsingTask;AssemblyFile;OutputPath;TaskName;ItemGroup;Db4oEnhance;TargetPath;AfterBuild;AbstractAssemblyInstrumentation;IAssemblyInstrumentation;TAInstrumentation;tp;EnhancementExample;tacustom;Db4oPersistent;typedef;classTargetDir;jarTargetDir;MaintenanceQueue;'Barrichello';'BMW';useIndexSystem;useRamSystem;discardSmallerThan;DiscardSmallerThan;allObjects;SumPilotPoints;SelectMinPointsPilot;AveragePilotPoints;CountSubGroups;SelectPilotsAndTrainees;SelectPilotsInRange;SelectAndChangePilots;SelectTestPilots6PointsMore;SelectPilots6To12Points;SelectPilotsRandom;SelectPilotsEven;SelectAnyOnePilot;SelectDistinctPilots;SelectAllPilots;SelectAllPilotsNonGeneric;GetSortedPilots;GetPilotsSortByNameAndPoints;GetPilotsSortWithComparator;SelectPilot5Points;SelectTestPilots;SelectPilotsNumberX6;newPackage;newClass;objectField;oldField;newField;newAssembly;ObjectField;aaplication">
    <head><title>String Encoding	<link href="../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" /><script type="text/javascript" src="../Resources/Code/prettify.js"></script></title>
    </head>
    <body onload="prettyPrint()">
        <h1>String Encoding</h1>
        <p>When db4o
stores and loads strings it has to convert them to and from byte arrays. By
default db4o provides three types of string encoding, which do this job: Unicode, UTF-8
and ISO 8859-1, Unicode being the default one. In general Unicode can represent
any character set. However, it also imposes a certain overhead, as character values
are stored in 4 bytes (less generic encoding usually use 2 or even 1 byte per
character). In order to save on the database file size, it is recommended to
use UTF-8, which only required 1 bytes per character. </p>
        <p>&#160;</p>
        <p>It's possible to configure your own string encoding implementation.</p>
        <p>CommonConfiguration#stringEncoding(stringEncoding)</p>
        <p>Where
stringEncoding can be either one of the default ones:</p>
        <p MadCap:conditions="Primary.Java,Primary.All languages">
            <p>Java:</p>
            <p>
                <pre class="prettyprint" xml:space="preserve">
EmbeddedConfiguration config = Db4oEmbedded.newConfiguration();
config.common().stringEncoding(StringEncodings.utf8());
Db4oEmbedded.openFile(config, "myDB.db4o");
				</pre>
            </p>
        </p>
        <p MadCap:conditions="Primary..NET">
            <p>.NET:  </p>
            <p>
                <pre class="prettyprint" xml:space="preserve">
IEmbeddedConfiguration config = Db4oEmbedded.NewConfiguration();
config.Common.StringEncoding = StringEncodings.Utf8();
Db4oEmbedded.OpenFile(config, "myDB.db4o");
				</pre>
            </p>
        </p>
        <p>or a newly implemented one:</p>
        <p MadCap:conditions="Primary.Java,Primary.All languages">
            <p>Java:  </p>
            <p>
                <pre class="prettyprint" xml:space="preserve">
EmbeddedConfiguration config = Db4oEmbedded.newConfiguration();
config.common().stringEncoding(new StringEncoding() {
    public byte[] encode(String s) {
       //TODO implement the encoding
       return null;
    }

    public String decode(byte[] bytes, int i, int i1) {
       //TODO implement the decoding
       return null;
    }
});
Db4oEmbedded.openFile(config,"myDB.db4o");
			</pre>
            </p>
        </p>
        <p MadCap:conditions="Primary:java" />
        <p MadCap:conditions="Primary..NET">
            <p>.NET:  </p>
            <p>
                <pre class="prettyprint" xml:space="preserve">
class MyEncoding : IStringEncoding
{
	public byte[] Encode(string str)
	{
		// TODO: Implement the encoding
		return null;
	}
	
	public string Decode(byte[] bytes, int start, int length)
	{
		// TODO: Implement the decoding
		return null;
	}
}

IEmbeddedConfiguration config = Db4oEmbedded.NewConfiguration();
config.Common.StringEncoding = new MyEncoding();
Db4oEmbedded.OpenFile(config, "myDB.db4o");
				</pre>
            </p>
        </p>
        <p>It is important to remember that the string
encoding is selected once for the lifetime of a database and cannot be changed
afterwards. With the default encoding it is enough to supply the encoding
configuration when the database is created, it will be picked up automatically
afterwards. With the custom string encoding's, you must make sure that the same
encoding is submitted with every database open call. As db4o uses string
encoding to store metadata information like field and classnames, opening a
database with a wrong string encoding will fail with exceptions.</p>
    </body>
</html>