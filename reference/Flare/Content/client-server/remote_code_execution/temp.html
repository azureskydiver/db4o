<?xml version="1.0" encoding="utf-8"?><html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="2958" MadCap:lastWidth="1029">
<head><title>Using Messaging API For Remote Code Execution	<link href="../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" />		<script type="text/javascript" src="../../Resources/Code/prettify.js"></script></title></head>
<body onload="prettyPrint()">
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Using Messaging API For Remote Code Execution</h1>

<p>Messaging API gives you an easy and powerful tool for remote code execution. The short overview of the API is in <a href="../messaging.htm" class="wikiLink">Messaging chapter</a>. </p>
<p>All you will need to do is to define specific message class or classes (should be shared between client and server).</p>
<p>The client side can issue messages using:</p>

<span name="cs_wiki_filter" csw_filters="java">
<p>Java: <code>MessageSender#send(message) </code></p>
</span>

<span name="cs_wiki_filter" csw_filters="cs">
<p>c#:   <code>IMessageSender#Send(message) </code></p>
</span>

<span name="cs_wiki_filter" csw_filters="vb">
<p>VB:   <code>IMessageSender#Send(message) </code></p>
</span>

<p>The server side should register a message listener:</p>

<span name="cs_wiki_filter" csw_filters="java">
<p>Java: <code>Configuration#setMessageRecipient(MessageRecipient)</code></p>
</span>

<span name="cs_wiki_filter" csw_filters="cs">
<p>c#: <code>Configuration#SetMessageRecipient(IMessageRecipient)</code></p>
</span>

<span name="cs_wiki_filter" csw_filters="vb">
<p>VB: <code>Configuration#SetMessageRecipient(IMessageRecipient)</code></p>
</span>
Message recipient should define a response to the different messages received in
<span name="cs_wiki_filter" csw_filters="java">
<p>Java: <code>processMessage(ObjectContainer objectContainer, Object message) </code></p>
</span>

<span name="cs_wiki_filter" csw_filters="cs">
<p>c#:   <code>ProcessMessage(IObjectContainer objectContainer, object message) </code></p>
</span>

<span name="cs_wiki_filter" csw_filters="vb">
<p><code>vb:   ProcessMessage(ByVal objectContainer As IObjectContainer, ByVal message As Object) </code></p>
</span>
<p>method. ObjectContainer parameter gives full control over the database.</p>
<p>Let's reset our database and try updating using special UpdateServer message.</p>
<span name="cs_wiki_filter" csw_filters="java">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.java: <span class="fscMemberName">setObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> setObjects() </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_33_333_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(DB4O_FILE_NAME).delete();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.openFile(DB4O_FILE_NAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_139_279_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">for</span><span style="color: #000000;"> (</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #000000;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> </span><span style="color: #000000;">5</span><span style="color: #000000;">; i</span><span style="color: #000000;">++</span><span style="color: #000000;">) </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_172_236_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Car car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">car</span><span style="color: #000000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> i);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        container.set(car);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      container.set(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> RemoteExample());
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Open_Text').style.display='inline';"/>    }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_SetObjects_1926_58_288_315_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      container.close();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    checkCars();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.java: <span class="fscMemberName">updateCarsWithMessage</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> updateCarsWithMessage() </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_44_1291_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Configuration configuration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.newConfiguration();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    configuration.messageLevel(</span><span style="color: #000000;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectServer server </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.openServer(configuration, DB4O_FILE_NAME, </span><span style="color: #000000;">0xdb40</span><span style="color: #000000;">);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    server.grantAccess(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">user</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">password</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> create message handler on the server</span><span style="color: #008000;">
</span><span style="color: #008080;">07</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    server.ext().configure().clientServer().setMessageRecipient(
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> MessageRecipient() </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_390_953_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> processMessage(
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              MessageContext context,
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Open_Text').style.display='inline';"/>              Object message) </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_479_947_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">//</span><span style="color: #008000;"> message type defines the code to be
</span><span style="color: #008080;">13</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">//</span><span style="color: #008000;"> executed</span><span style="color: #008000;">
</span><span style="color: #008080;">14</span><span style="color: #008000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Open_Text').style.display='inline';"/></span><span style="color: #000000;">            </span><span style="color: #0000FF;">if</span><span style="color: #000000;"> (message </span><span style="color: #0000FF;">instanceof</span><span style="color: #000000;"> UpdateServer) </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_587_940_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              Query q </span><span style="color: #000000;">=</span><span style="color: #000000;"> context.container().query();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              q.constrain(Car.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              ObjectSet objectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.execute();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Open_Text').style.display='inline';"/>              </span><span style="color: #0000FF;">while</span><span style="color: #000000;"> (objectSet.hasNext()) </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_743_895_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Car car </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Car) objectSet.next();
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                car.setModel(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Updated2-</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #000000;">+</span><span style="color: #000000;"> car.getModel());
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                context.container().set(car);
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>              }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              context.container().commit();
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>          }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">);
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_962_1240_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ObjectContainer client </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4o.openClient(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">localhost</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #000000;">0xdb40</span><span style="color: #000000;">, </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">user</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">password</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> send message object to the server</span><span style="color: #008000;">
</span><span style="color: #008080;">31</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">      MessageSender sender </span><span style="color: #000000;">=</span><span style="color: #000000;"> client.ext().configure()
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          .clientServer().getMessageSender();
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      sender.send(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> UpdateServer());
</span><span style="color: #008080;">34</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      client.close();
</span><span style="color: #008080;">35</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Open_Text').style.display='inline';"/>    }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteJava.ZipsRemoteExample.Java_RemoteExample.Java_UpdateCarsWithMessage_1984_65_1249_1273_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">36</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      server.close();
</span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">38</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    checkCars();
</span><span style="color: #008080;">39</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>  </p>
</span>

<span name="cs_wiki_filter" csw_filters="cs">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.cs: <span class="fscMemberName">SetObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> SetObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_35_333_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      File.Delete(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_139_274_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">for</span><span style="color: #000000;"> (</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;">; i </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> </span><span style="color: #800080;">5</span><span style="color: #000000;">; i</span><span style="color: #000000;">++</span><span style="color: #000000;">) 
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_178_236_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Car car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">car</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">i);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          db.Set(car);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Set(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> RemoteExample());
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_SetObjects_2118_54_291_313_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Close();
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      CheckCars();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.cs: <span class="fscMemberName">UpdateCarsWithMessage</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdateCarsWithMessage() 
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Open_Text').style.display='inline';"/>    </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_47_915_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IConfiguration configuration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration();
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">//</span><span style="color: #008000;"> create message handler on the server</span><span style="color: #008000;">
</span><span style="color: #008080;">05</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            configuration.ClientServer().SetMessageRecipient(
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> UpdateMessageRecipient());
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectServer server</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4oFactory.OpenServer(configuration, Db4oFileName,</span><span style="color: #800080;">0xdb40</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            server.GrantAccess(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">user</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">password</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_420_853_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> send message object to the server</span><span style="color: #008000;">
</span><span style="color: #008080;">12</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                IConfiguration clientConfiguration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                IMessageSender sender </span><span style="color: #000000;">=</span><span style="color: #000000;"> clientConfiguration.ClientServer().GetMessageSender();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                IObjectContainer client </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenClient(clientConfiguration, 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">localhost</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">0xdb40</span><span style="color: #000000;">, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">user</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">password</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        sender.Send(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> UpdateServer());
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        client.Close();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Open_Text').style.display='inline';"/>      </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteCS.ZipsRemoteExample.Cs_RemoteExample.Cs_UpdateCarsWithMessage_2172_61_869_895_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        server.Close();
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      CheckCars();
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>  </p>
</span>

<span name="cs_wiki_filter" csw_filters="vb">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.vb: <span class="fscMemberName">SetObjects</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub SetObjects()</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_SetObjects_2302_54_15_511_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> SetObjects()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            File.Delete(Db4oFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(Db4oFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> i </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Integer</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">For</span><span style="color: #000000;"> i </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #800080;">0</span><span style="color: #000000;"> </span><span style="color: #0000FF;">To</span><span style="color: #000000;"> </span><span style="color: #800080;">5</span><span style="color: #000000;"> </span><span style="color: #000000;">-</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Step</span><span style="color: #000000;"> i </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800080;">1</span><span style="color: #000000;">
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> car </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">car</span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;"> i.ToString())
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    db.Set(car)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Next</span><span style="color: #000000;">
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Set(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> RemoteExample())
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Close()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            CheckCars()
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">RemoteExample.vb: <span class="fscMemberName">UpdateCarsWithMessage</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdateCarsWithMessage()</span><span id="ResourcesReferenceClient-ServerRemote_Code_ExecutionremoteVB.ZipsRemoteExample.Vb_RemoteExample.Vb_UpdateCarsWithMessage_2356_61_15_1000_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdateCarsWithMessage()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">'</span><span style="color: #008000;"> create message handler on the server</span><span style="color: #008000;">
</span><span style="color: #008080;">03</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> configuration </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IConfiguration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration()
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            configuration.ClientServer.SetMessageRecipient(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> UpdateMessageRecipient())
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> server </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectServer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenServer(configuration, Db4oFileName, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">HDB40)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            server.GrantAccess(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">user</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">password</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> clientConfiguration </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IConfiguration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.NewConfiguration()
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> sender </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IMessageSender </span><span style="color: #000000;">=</span><span style="color: #000000;"> clientConfiguration.ClientServer().GetMessageSender()
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> client </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenClient(clientConfiguration, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">localhost</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #000000;">&amp;</span><span style="color: #000000;">HDB40, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">user</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800000;">&quot;</span><span style="color: #800000;">password</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> send message object to the server</span><span style="color: #008000;">
</span><span style="color: #008080;">12</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                sender.Send(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> UpdateServer())
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                client.Close()
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                server.Close()
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            CheckCars()
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>  </p>
</span>You can also put some information in the message being sent (UpdateServer class).
<p>The advantage of this method is that having predefined message types you can make any changes to the handling code only on the server side. In the situations with many distributed clients it can really save you lots of time on support.</p></div>
    </div>
    
  </body></html>