<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="7" MadCap:lastHeight="5406" MadCap:lastWidth="1210" MadCap:conditions="Primary..NET">
    <head><title>TA Enhancement With Db4oTool	<link href="../../../../Resources/Stylesheets/prettify.css" type="text/css" rel="stylesheet" /><script type="text/javascript" src="../../../../Resources/Code/prettify.js"></script></title>
    </head>
    <body onload="prettyPrint()">
         
             
                <h1>TA Enhancement With Db4oTool</h1>
                <p>TA instrumentation can be done by appilying </p>
                <p><a href="../../../../implementation_strategies/enhancement_tools/enhancement_for_.net/db4otool.htm"  >Db4oTool</a> utility to the ready .NET assemblies:</p>
                <p><code>Db4oTool -ta assembly</code>
                </p>
                <p>Let's look at a simple example. We will use SensorPanel
class from <a href="../../../activation.htm"  >Activation</a> example: </p>
                <p MadCap:conditions="Primary..NET,Primary.c#">
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/SensorPanelTA.cs/SensorPanelTA.cs.flsnp" />
                </p>
                <p MadCap:conditions="Primary:cs" />
                <p MadCap:conditions="Primary..NET,Primary.VB.NET">
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/SensorPanelTA.vb/SensorPanelTA.vb.flsnp" />
                </p>
                <p MadCap:conditions="Primary:vb" />
                <p>In your code you will need to add Transparent Activation
support to the configuration:</p>
                <p MadCap:conditions="Primary..NET,Primary.c#">
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.cs/ConfigureTA.flsnp" />
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.cs/StoreSensorPanel.flsnp" />
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.cs/TestActivation.flsnp" />
                </p>
                <p MadCap:conditions="Primary:cs" />
                <p MadCap:conditions="Primary..NET,Primary.VB.NET">
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.vb/ConfigureTA.flsnp" />
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.vb/StoreSensorPanel.flsnp" />
                    <MadCap:snippetBlock src="../../../../Resources/Snippets/TA Enhancement With Db4oTool/TAExample.vb/TestActivation.flsnp" />
                </p>
                <p MadCap:conditions="Primary:vb" />
                <p>Compile and run the application. Now, you can add TA support by using the following
command-line:</p>
                <p><code>Db4oTool -ta TAExamples.exe</code>
                </p>
                <p>use -vv option for verbose output:</p>
                <p><code>Db4oTool -ta -vv TAExamples.exe</code>
                </p>
                <p>You can also apply type filter to TA enable only selected
types:</p>
                <p><code>Db4oTool.exe -vv -ta -by-name:S* TAExamples.exe</code>
                </p>
                <p>Db4oTool uses .NET regex to parse the -by-name parameter,
in the example above all types starting with "S" will be TA enabled.</p>
                <p>Run TA enabled assembly and compare results to the previous run. </p>
             
         
    </body>
</html>