<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Rollback And Cache</title>
    <link rel="stylesheet" type="text/css" href="../../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Rollback And Cache</h1><p><br></p><p>Suppose we have <a href="car.htm" class="wikiLink">Car</a>, <a href="pilot.htm" class="wikiLink">Pilot</a> and <a href="id.htm" class="wikiLink">Id</a>
classes stored in the database. Car class is activatable, others are not. We
will modify the car and rollback the transaction:</p>







<p>If the transaction was going on normally (commit), we would
have had the car modified in the database as it is supported by Transparent
Persistence. However, as the transaction was rolled back - no modifications
should be done to the database. The result that is printed to the screen is
taken from the reference cache, so it will show modified objects. That is
confusing and should be fixed:</p>







<p>Here we've added a <code>deactivate</code> call for the car
object. This call is used to clear the reference cache and its action is
reversed to <code>activate</code>. </p>

<p>We've used Integer.MAX_VALUE/Int32.MaxValue to deactivate
car fields to the maximum possible depth. Thus we can be sure that all the car
fields will be re-read from the database again (no outdated values from the
reference cache), but the trade-off is that all child objects will be
deactivated and read from the database too. You can see it on Pilot object.
This behaviour is preserved for both activatable and non-activatable objects.</p></div>
    </div>
    <div id="footer">
					This revision (1) was last Modified 2008-03-02T09:33:06 by Tetyana.
				</div>
  </body>
</html>