---++ Bugs:

---+++ .NET:

   * For system types like Guid, DateTime, Uri, The ToString value really has to be shown.

   * Why does IList and ISerializable show up in the initial list of types? They show up as having no instances.

   * When showing the values of all of the fields of an instance, if the value is an object in it's own right, show the object ID of the value, and double-clicking it should focus on that object, or make it expandable.

   * Some way to show the type heirachy for a class. Example is ClassB : ClassA, the field inspector should show all fields defined by ClassB and ClassA with an additional line to note that ClassB is ClassA. When expanding the branch for ClassA (since it shows up in the inital list), also list instances of ClassB as ClassB (I think this should work).

   * Branches for class types which are marked abstract cannot be expanded.

   * P2LinkedLists do not show all list objects. User (may) have to navigate i_next members to get to all of the list elements.

   * Some exceptions: 

<verbatim>
Exception handling tree selection change 
java.lang.NullPointerException 
        at com.db4o.YapHandlers.handlerForClass(Unknown Source) 
        at com.db4o.YapClass.addMembers(Unknown Source) at 
        com.db4o.YapClass.checkChanges(Unknown Source) at 
        com.db4o.YapClassCollection.readYapClass(Unknown Source) 
        at com.db4o.YapClassCollection.getYapClass(Unknown Source) 
        at com.db4o.YapStream.getYapClass(Unknown Source) at 
        com.db4o.YapField.loadHandler(Unknown Source) at 
        com.db4o.YapClass.forceRead(Unknown Source) at 
        com.db4o.YapClass.readThis(Unknown Source) at 
        com.db4o.YapClassCollection.readYapClass(Unknown Source) 
        at com.db4o.YapClassCollection.getYapClass(Unknown Source) 
        at com.db4o.YapStream.getYapClass(Unknown Source) at 
        com.db4o.QConClass.<init>(Unknown Source) at 
        com.db4o.QQuery.constrain(Unknown Source) at 
        com.db4o.browser.model.Db4oDatabase.instances(Db4oDatabase.java:114) at 
        com.db4o.browser.model.Db4oDatabase.instanceIds(Db4oDatabase.java:123) at 
        com.db4o.browser.model.nodes.ClassNode.children(ClassNode.java:61) at 
        com.db4o.browser.model.AbstractGraphIterator.selectNextChild(AbstractGraphIterator.java:93) at 
        com.db4o.browser.gui.controllers.DetailController.setInput(DetailController.java:53) at 
        com.db4o.browser.gui.controllers.SelectionChangedController.selectionChanged(SelectionChangedController.java:39) at 
        com.db4o.browser.model.AbstractGraphIterator.fireSelectionChanged
        Event(AbstractGraphIterator.java:53) at 
        com.db4o.browser.model.AbstractGraphIterator.setSelectedPath(AbstractGraphIterator.java:45) at 
        com.db4o.browser.gui.controllers.tree.TreeSelectionChangedController.selectionChanged(TreeSelectionChangedController.java:40) at 
        org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:163) at 
        org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1015) at 
        org.eclipse.core.runtime.Platform.run(Platform.java:757) at 
        org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:161) at 
        org.eclipse.jface.viewers.StructuredViewer.updateSelection(StructuredViewer.java:1676) at 
        org.eclipse.jface.viewers.StructuredViewer.handleSelect(StructuredViewer.java:935) at 
        org.eclipse.jface.viewers.StructuredViewer$4.widgetSelected(StructuredViewer.java:961) at 
        org.eclipse.jface.util.OpenStrategy.fireSelectionEvent(OpenStrategy.java:209) at 
        org.eclipse.jface.util.OpenStrategy.access$3(OpenStrategy.java:204) at 
        org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:364) at 
        org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82) at 
        org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842) at 
        org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2908) at 
        org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2541) at 
        com.db4o.browser.gui.standalone.SWTProgram.runWithLog(SWTProgram.java:101) at 
        com.db4o.browser.gui.standalone.StandaloneBrowser.main(StandaloneBrowser.java:232)
Exception handling tree selection change 
java.lang.NullPointerException 
        at com.db4o.YapHandlers.handlerForClass(Unknown Source) 
        at com.db4o.YapClass.addMembers(Unknown Source) at 
        com.db4o.YapClass.checkChanges(Unknown Source) at 
        com.db4o.YapClassCollection.readYapClass(Unknown Source) 
        at com.db4o.YapClassCollection.getYapClass(Unknown Source) 
        at com.db4o.YapStream.getYapClass(Unknown Source) at 
        com.db4o.QConClass.<init>(Unknown Source) at 
        com.db4o.QQuery.constrain(Unknown Source) at 
        com.db4o.browser.model.Db4oDatabase.instances(Db4oDatabase.java:114) at 
        com.db4o.browser.model.Db4oDatabase.instanceIds(Db4oDatabase.java:123) at 
        com.db4o.browser.model.nodes.ClassNode.children(ClassNode.java:61) at 
        com.db4o.browser.model.AbstractGraphIterator.selectNextChild(Abstract GraphIterator.java:93) at 
        com.db4o.browser.gui.controllers.DetailController.setInput(DetailController.java:53) at 
        com.db4o.browser.gui.controllers.SelectionChangedController.selectionChanged(SelectionChangedController.java:39) at 
        com.db4o.browser.model.AbstractGraphIterator.fireSelectionChangedEvent(AbstractGraphIterator.java:53) at 
        com.db4o.browser.model.AbstractGraphIterator.setSelectedPath(AbstractGraphIterator.java:45) at 
        com.db4o.browser.gui.controllers.tree.TreeSelectionChangedController.selectionChanged(TreeSelectionChangedController.java:40) at 
        org.eclipse.jface.viewers.Viewer$2.run(Viewer.java:163) at 
        org.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:1015) at 
        org.eclipse.core.runtime.Platform.run(Platform.java:757) at 
        org.eclipse.jface.viewers.Viewer.fireSelectionChanged(Viewer.java:161) at 
        org.eclipse.jface.viewers.StructuredViewer.updateSelection(StructuredViewer.java:1676) at 
        org.eclipse.jface.viewers.StructuredViewer.handleSelect(StructuredViewer.java:935) at 
        org.eclipse.jface.viewers.StructuredViewer$4.widgetSelected(StructuredViewer.java:961) at 
        org.eclipse.jface.util.OpenStrategy.fireSelectionEvent(OpenStrategy.java:209) at 
        org.eclipse.jface.util.OpenStrategy.access$3(OpenStrategy.java:204) at 
        org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:364) at 
        org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:82) at
        org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:842) at 
        org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:2908) at 
        org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:2541) at 
        com.db4o.browser.gui.standalone.SWTProgram.runWithLog(SWTProgram.java:101) at 
        com.db4o.browser.gui.standalone.StandaloneBrowser.main(StandaloneBrowser.java:232) 
</verbatim>

----+++ Cross-platform

   * needs to be able to cope with refactored classes:
      * instances may have multiple fields of the same name
  
   * Query untyped variables by specifying the type

   * The toolbar leaks SWT Image resources **POSTPONED**
   
   * XSWT.parse disposes all resources in an application in its dispose listener! **POSTPONED**
   
   * Extend classpath needs to be moved to a preference page.  Right now you have to extend the classpath before you open a database file or it doesn't work. **DONE**
   
   * Reopen databases after changing classpath preference. **DONE**

   * When a database is reopened after updating classpath, the generic reflector is no longer used, causing instability


---++ Remaining Features:

   * Beautify UI; add icons in appropriate places
      * On buttons: forward*, back*, Query*, Search*  **DONE**
      * On tabs: database* versus query*  **DONE**
      * On QBE: Class*; field* **DONE**
      * In tree: Icon for each node type*
   * Implement tree layout algorithm for expanded classes **POSTPONED**
   * Implement grabbing hand scrolling mode for large queries
   * Click right side to navigate
      * (Hyperlink objects if object.hasChildren()?)
   * If right side is displaying a collection, display in a table
   * Connect to a db4o server **DONE**
   * Extend classpath should be a preference page **DONE**
   
---++ Release engineering

   * Don't support PDAs for the initial release **DONE**
   * 3 Packages, downloadable separately **DONE**
   * Implement C-based program launcher **DONE**
   * Nullsoft installer for Windows platforms  (Rodrigo)
   * Write reproducable build script!!!!!!!!

<verbatim>
Postponed Features:
-------------------
- Figure out what class is selected in tree when File|Query... or query button pressed.
   Highlight that class by default in query dialog.
- Catch up MockDatabase to the generic reflector impl
- Customize display of nodes
- After initial release: fix tree/detail to implement IMaster/IDetail; submit
  changes to JFace

Fixed bugs:
-----------
- Add converter declarations for primitive wrapper classes **DONE**
- Ensure that strings are fully parsed on date conversion **DONE**
- Selecting an item from the query result and then posing a query
  with an empty result triggers a stack exception from GraphPosition **DONE**


   * Write a file logger that logs to a log file in the user's home directory **DONE**
   * Write About dialog **DONE**
   * Don't automatically expand classes in QBE pane; include button on fields **DONE**
   * Substring search: just search displayed strings **DONE**
   * REGRESSION: History buttons don't work any more!?! **DONE**
   * ListChooserDialog: Include search capability **DONE**
      - If a class is selected in tree view, select it in list by default
   * Remove package names from tabs **DONE**
   * Add database file name to tab text **DONE**
   * Clear history button history when query is run **DONE**
   * List in ListChooserDialog doesn't scroll **DONE**
   * ClassNode should not always create InstanceNode subnodes.  **DONE**
   * Map and collection instances need IDs displayed. **DONE**

- Query in separate tab **DONE**
- Choose class dialog **DONE**
- Create query controller object **DONE**

- Be able to display query results
  - Generate a query model from a ReflectClass **DONE**
  - Get the initial query from the model **DONE**
  - Run the query **DONE**
  - Create an IGraphIterator for the ObjectSet **DONE**
  - Dynamically expand contained classes

- Populate the model from the ReflectClass graph **DONE**
   
- Generate/run a SODA query from the query model when the Run button is clicked **DONE**

- Add try/catch around all TreeViewer strategy object methods / log exceptions **DONE**

   * Sort classes by name in tree view. **DONE**
   * ArrayItemNode is not aware of simple types. **DONE**
   * Remove array types from initial view. **DONE**
   * Search result scalability. **DONE**
   * Begin query UI / querying functionality **DONE**

- Testing
   * Generic reflector; run with .net (DONE)
   * Arrays (DONE, n-dimensional fail)
   * Test with no classes (DONE)

- Make sure browsing scales to large numbers of nodes **DONE**

- Generic reflector
   * StoredIterableFieldNode - Needs to use Platform.isCollection **DONE**
   * Need to write StoredMapFieldNode **DONE**
   * Make sure there are no java.lang.reflect calls where there shouldn't be **DONE, I think**
   * Test with no classes available

- StoredArrayFieldNode needs implemented **DONE**

- Test with J9 VM **????**


- Maps don't display correctly **DONE**
- Arrays don't display correctly **DONE**
    
 - Unit testing verify that the iterator is always restored after it is used
    * template generator



----

User feedback:

Please show for every class:
-- All members of the class (preferably with an expanding branch for 
members defined in any base class(es).
-- The names of the members as well as the defined type of the field
-- The Value of each field and the type of the stored value (this is 
importaint)
-- For fields containing objects, an easy way to double-click or navigate 
to the object. It would be cool to show the db4o object ID for reference.
-- For objects containing an array/collection, a way to see all 
objects/values stored in the array, by index.
-- Please pay special attention to things like the Db4o LinkedList and 
HashMap classes!



It should be possible to browse a db4o-Database WITHOUT having the original
class-definitions (no dll, no source available)

I once got an old .yap file from a client and i didn't have the old
class-definitions. It was a very hard job to browse and repair some simple
data.

would be nice to be able to modify data too  :-) 

----

YapReader / YapWriter -- Byte array encoder/decoder

Like taking a void* and typecasting it to some struct.

Or like taking a memory buffer and reading it into a data division

YapBit -- Like a sequential file that reads a bit at a time


----

- Follow up using the bottom-up strategy getting db4o into Red Hat.

- Follow up with Karen Bennett of Red Hat regarding getting db4o into Red Hat and getting
    GCJ support into Eclipse.

- Extending VEP article

- Work with Sybase, BEA, and Actuate on DB API (after browser spike)

- Follow up about getting into OSCon (*done*)

- After first browser spike done; look at BIRT API; make suggestions for oo improvements.

---------------------

Standardization discussion:

here is the result of our discussion yesterday as I
remember it:


(1) How will our standard look like?

- We don't want to go JDO.
- S.O.D.A. is not intuitive enough.
- Even if we follow the new "Java method safe query"
approach, we will need to build some kind of tree.
- Let's use a new API and make it look as much like
SQL as we can.


(2) Our browser

The majority of the work for our browser will be to
get the GUI right. This is largely independant of
the way our querying API will look. We can port this
S.O.D.A. to our new dialect in no time (2 days).


(3) How do we fit in with other standards?

We don't.
EJB 3.0 is too slow.
JDO 2.0 is too ugly.


(4) Eclipse vs. JCP standardisation bodies.

Eclipse is faster. You just go and do it. 
That's what we will do. 



---------------------


Problems with current design:

- The Model strictly represents an open database file.  It does not represent search results.

- Opening a new database file results in closing and opening the Model object.  It should
  rather tell the Model to open a new database file and then the Model should trigger a refresh
  to all listening views.
  
- The current View object mix in Controller functionality.  Controllers should be separate objects.

- There should be separate Controller objects for each part of the window:
    * Tree
    * Path string
    * Hyperlink area
    * Object field pane
    
- The Model object currently just wraps an ObjectContainer and adds convenience methods.

- The FieldNode hierarchy represents the Model, but also embeds navigation into it!!!

- Navigating/Visiting aspects of the Model should be separated out of the Model graph using the Iterator
  pattern.  The Iterator should be a hierarchy/graph Iterator, and should embed a stack, the 
  visual representation of which will be the path string in the detail pane.
  
- This stack will be how we traverse up the tree control from its root to keep its focus
  synchronized with the detail pane.
  
- This Visitor becomes like the INavigator framework in Essential Data.

- This is how we provide an ED-like provider framework for JFace TreeViewers.


----------------------

Be able to see how many subobjects per node
Break down lists into 1..50, 51-100, etc...
Click on a Java class in package explorer, see instances


Display properties:
  Be able to configure the following on a global or a package basis:
    (select packages by substring or regex)

Display nodes: in addition to toString():
getDeclaredType(), getConcreteType(), getImplementedType(), 
call a specific method, use a special field;

*.*      [declared] [concrete] [method:(name)] [field:(name)]
*.db4o   [concrete] [method:(name)] [field:(name)]
         [declared] [concrete] [method:(name)] [field:(name)]
         [declared] [concrete] [method:(name)] [field:(name)]
         [declared] [concrete] [method:(name)] [field:(name)]


Filter from search box; limit search depth (add UI for this)
 - Incremental search
 - Regular expression


- Hide package names option
- Hide these classes option (for hiding system classes)


*DONE* Put SWT application launching instructions in /dev


April: version 1.0
October timeframe: mature browser



Carl's notes:

  Popup Nodes, if there are too many. Display first 50 and use node to expand
  Would like to see the number items per class
  Double-clicking on a node: Browse from here.
  History for objects
  Update the browse view from selecting class in Java perspective
  Declared type and implemented type
  Hide package names

  [declared type] [concrete type] [method:toString] [method:(name)] [field:(name)]


Use-cases:

1) Run on mobile devices

2) Debug use-cases:

2.1) Navigate
2.2) Query
2.3) Visualize object graphs  (Java Spider)


</verbatim>

