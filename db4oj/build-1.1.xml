<project name="db4o-java1.1" default="publish"  xmlns:ivy="antlib:fr.jayasoft.ivy.ant">
	
	<import file="../build-1.1/common-1.1.xml"/>
	
	<property file="${dir.j}/build-1.1.properties" />
	
	<target name="echo" >
		<echo message="${tempOne}"/>
	</target>
	
	<target name="clean">
		<cleanIvyDir/>
	</target>
	
	<target name="init">
		<tstamp />
		<initIvyDir/>
		<buildDb4oDevTool/>
	</target>
	
	<target name="jar" depends="init">		
		<resetDir dir="${tempOne}"/>
		
		<copyjava1.1 destDir="${tempSrcDir}" />		
		
		<versioninfo 
			path="${tempSrcDir}/com/db4o" 
			java="true" 
			version="${db4o.version.full}" 
			major="${db4o.version.major}" 
			minor="${db4o.version.minor}" 
		/>
		
		<javac fork="yes" executable="${file.compiler.jdk1.3}"
			srcdir="${tempSrcDir}" destdir="${tempOne}" debug="off">
			<compilerarg line="${file.compiler.jdk1.3.args} ${file.compiler.jdk1.3.args.optional}"/>
		</javac>
		
		<jar jarfile="${coreJarPath}" basedir="${tempOne}" />
		
		<antcall target="updateDb4oVersion" />
	</target>
	
	<target name="updateDb4oVersion" if="updateSvnLocalCopy" >
		<copy file="${tempSrcDir}/com/db4o/Db4oVersion.java" tofile="${dir.j.core.src}/com/db4o/Db4oVersion.java" overwrite="true"/>
	</target>
	
	 <target name="configure" depends="init">
        <ivy:configure file="${ivy.conf.dir}/ivyconf.xml" />
   </target>
   

    <target name="resolve" depends="configure">
        <ivy:resolve file="${dir.j}/ivy.xml"/>   
   		  <ivy:retrieve pattern="${ivy.retrieve.pattern}" conf="${ivy.configurations}" />
    </target>
    
    <target name="publish" depends="resolve, jar">
    	<publishToIvy/>
    	<antcall target="clean" />
    </target>
</project>
