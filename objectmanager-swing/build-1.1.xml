<project name="objectmanager-swing" default="publish"  xmlns:ivy="antlib:fr.jayasoft.ivy.ant">
	<import file="../build-1.1/common-1.1.xml"/>
	
	<dirname property="objectmanager-swing.basedir" file="${ant.file}"/>	
	
	<property file="${objectmanager-swing.basedir}/build-1.1.properties" />
	
	<target name="clean">
  	<cleanIvyDir/>
	</target>
	
	<target name="init" depends="clean">
		<tstamp />
		<initIvyDir/>		
	</target>
	
	 <target name="configure" depends="init">
        <ivy:configure file="${ivy.conf.dir}/ivyconf.xml" />
   </target>
   
   <target name="resolve" depends="configure">
        <ivy:resolve file="${objectmanager-swing.basedir}/ivy.xml"/>   
   		  <ivy:retrieve pattern="${ivy.retrieve.pattern}" conf="${ivy.configurations}" />
    </target>
   
   <target name="publish" depends="zip">
			<publishToIvy/>
	</target>

	<target name="compile" depends="resolve" >
		<path id="class.path">
			<fileset dir="${ivy.lib.dir}" includes="*.jar"/>
			<fileset dir="${objectmanager-swing.basedir}/lib" includes="*.jar"/>
		</path>
		
		<resetDir dir="${tempOne}"/>
		<javac srcdir="${objectmanager-swing.basedir}/src" destdir="${tempOne}"
				debug="true" 
				source="1.5" target="1.5">
            <classpath refid="class.path"/>
        </javac>
		<!-- copy resources -->
		<copy todir="${tempOne}" filtering="false">
            <fileset dir="${objectmanager-swing.basedir}/src">
                <include name="**/*.gif"/>
                <include name="**/*.jpg"/>
                <include name="**/*.png"/>
            </fileset>
        </copy>		
	</target>	
	
	<target name="jar" depends="compile">
        <jar jarfile="${jarPath}" basedir="${tempOne}">
            <manifest>
                <attribute name="Class-Path"
                           value="lib/db4o-java5-${db4o.version.dotted}.jar lib/db4o-sql.jar lib/looks-2.0.4.jar lib/forms-1.0.7.jar lib/objectmanager-api-${db4o.version.dotted}.jar"/>
                <attribute name="Main-Class" value="com.db4o.objectManager.v2.Dashboard"/>
            </manifest>
        </jar>
	</target>
	
		<target name="zip" depends="jar"
            description="generate the distribution">
			
		<zip destfile="${zipPath}">
			<zipfileset dir="${objectmanager-swing.basedir}/docs" prefix="${zipDir}/docs"/>
			<zipfileset dir="${objectmanager-swing.basedir}/lib" prefix="${zipDir}/lib"/>
			<zipfileset dir="${ivy.lib.dir}" prefix="${zipDir}/lib"/>
			<zipfileset dir="${defaultArtifactDir}" prefix="${zipDir}"/>
			<zipfileset dir="${objectmanager-swing.basedir}/launch" prefix="${zipDir}"/>
		</zip>	
	</target>
</project>
