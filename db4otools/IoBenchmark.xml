<?xml version="1.0" encoding="UTF-8"?>
<project name="db4o-IoBenchmark" default="run.benchmark.small">

	<target name="init">
		<property file="IoBenchmark.properties" />
	</target>
	
	<target name="run.benchmark.small" depends="init">
		<run.benchmark object.count="${object.count.small}"/>
	</target>
	
	<target name="run.benchmark.medium" depends="init">
		<run.benchmark object.count="${object.count.medium}"/>
	</target>
	
	<target name="run.benchmark.large" depends="init">
		<run.benchmark object.count="${object.count.large}"/>
	</target>
	
	<macrodef name="run.benchmark">
		<attribute name="object.count" />
		<sequential>
			<java classname="com.db4o.bench.IoBenchmark" failonerror="true" fork="true">
				<classpath>
					<pathelement location="bin"/>
					<pathelement location="lib/${db4o.jar}"/>
					<pathelement location="lib/nano-timing.jar"/>
				</classpath>
				<jvmarg line="${jvm.args}"/>
				<arg line="@{object.count}" />
				<arg line="${db.file.name}" />
				<arg line="${results.file.1}" />
				<arg line="${results.file.2}" />
			</java>
		</sequential>
	</macrodef>
	
</project>