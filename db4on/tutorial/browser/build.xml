<?xml version="1.0"?>
<project name="db4ontutorialbrowser" default="update-doc">
	
	<property file="../../../db4obuild/machine.properties" />
	<property file="../../../db4obuild/ant.properties" />
	
	<property name="dir.browser.build" location="${dir.n.tutorial.browser}/bin" />
	<property name="dir.out" location="${dir.j.tutorial.out.net}" />	
	
	
	<property name="db4o.dll" location="${file.dll.net}" />	
	<property name="exe.name" value="db4o-tutorial.exe" />
	
	<target name="run" depends="update-doc">
		<exec dir="${dir.out}" executable="${dir.out}/${exe.name}">
		</exec>
	</target>
	
	<target name="update-doc" depends="build">
		<copy todir="${dir.out}">
			<fileset dir="${dir.browser.build}">
				<include name="bin/*.dll" />
				<include name="${exe.name}" />
				<include name="${exe.name}.config" />
			</fileset>
		</copy>
	</target>

	<target name="build" depends="init">
		
		<csc targetType="winexe"
			destFile="${dir.browser.build}/${exe.name}"
			win32icon="src/resources/db4o.ico">			
			
			<resource
				file="src/db4obrowser.WebBrowserViewControl.resources" embed="true" />
				
			<resource
				file="src/db4obrowser.TutorialOutlineViewControl.resources" embed="true" />
			
			<src dir="src">
				<include name="**/*.cs" />
			</src>
			
			<reference dir="${dir.browser.build}">
				<include name="db4o-samples.dll" />
				<include name="WeifenLuo.WinFormsUI.dll" />
				<include name="AxSHDocVw.dll" />
				<include name="SHDocVw.dll" />
				<include name="System.Windows.Forms.dll" />
			</reference>			
		</csc>
		
		<copy tofile="${dir.browser.build}/${exe.name}.config" file="src/app.config" />
	</target>

	<target name="init" depends="build-tutorial">
		<mkdir dir="${dir.browser.build}" />
		<copy todir="${dir.browser.build}" file="${db4o.dll}" />
		<copy todir="${dir.browser.build}" file="${dir.n.tutorial}/bin/db4o-samples.dll" />
		<copy todir="${dir.browser.build}">
			<fileset dir="lib">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>
	
	<target name="build-tutorial">
		<ant dir="${dir.n.tutorial}" />
	</target>
	
	<target name="clean">
		<delete dir="${dir.browser.build}" />
		<ant dir="${dir.n.tutorial}" target="clean" />
	</target>

</project>
