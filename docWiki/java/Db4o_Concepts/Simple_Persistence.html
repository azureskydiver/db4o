<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Simple Persistence</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Simple Persistence</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script><p>&nbsp;</p><p>db4o makes your work with persistent objects very simple and 
straightforward.&nbsp;The only #set(object) method is used for both saving and 
modification of any&nbsp;object that exists in your model.</p><p><span class="java"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.java: <span class="fscMemberName">storePilot</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> storePilot() </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_32_492_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(YAPFILENAME).delete();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ObjectContainer db</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(YAPFILENAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_135_416_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Pilot pilot</span><span style="color: #000000;">=</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Michael Schumacher</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          db.set(pilot);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Stored </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">pilot);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          </span><span style="color: #008000;">//</span><span style="color: #008000;"> change pilot and resave updated</span><span style="color: #008000;">
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">          pilot.addPoints(</span><span style="color: #000000;">10</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          db.set(pilot);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Stored </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">pilot);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Open_Text').style.display='inline';"/>        }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_storePilot_244_55_425_457_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          db.close();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        retrieveAllPilots();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.java: <span class="fscMemberName">updatePilotWrong</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> updatePilotWrong() </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_38_462_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      storePilot();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ObjectContainer db</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(YAPFILENAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_120_395_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> Even completely identical Pilot object
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #008000;">//</span><span style="color: #008000;"> won't work for update of the saved pilot</span><span style="color: #008000;">
</span><span style="color: #008080;">07</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Michael Schumacher</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">10</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        pilot.addPoints(</span><span style="color: #000000;">10</span><span style="color: #000000;">);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.set(pilot);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Added 10 points for </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">pilot);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Open_Text').style.display='inline';"/>        }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilotWrong_299_60_404_430_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.close();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      retrieveAllPilots();
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div> </p><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.java: <span class="fscMemberName">updatePilot</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> updatePilot() </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_33_465_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      storePilot();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ObjectContainer db</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(YAPFILENAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_115_401_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">          ObjectSet result</span><span style="color: #000000;">=</span><span style="color: #000000;">db.get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Michael Schumacher</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">10</span><span style="color: #000000;">));
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          Pilot found</span><span style="color: #000000;">=</span><span style="color: #000000;">(Pilot)result.next();
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          found.addPoints(</span><span style="color: #000000;">10</span><span style="color: #000000;">);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          db.set(found);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Added 10 points for </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">found);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Open_Text').style.display='inline';"/>    }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_updatePilot_364_55_410_434_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      db.close();
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    retrieveAllPilots();
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div></span> </p><p><span class="cs"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.cs: <span class="fscMemberName">StorePilot</span></span></div><div class="fscCode"><pre ID="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> StorePilot()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Open_Text').style.display='inline';"/>    </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_34_407_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      File.Delete(YapFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_135_341_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Set(pilot);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> change pilot and resave updated</span><span style="color: #008000;">
</span><span style="color: #008080;">10</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        pilot.AddPoints(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Set(pilot);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_StorePilot_451_51_357_379_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Close();
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      RetrieveAllPilots();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.cs: <span class="fscMemberName">UpdatePilotWrong</span></span></div><div class="fscCode"><pre ID="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotWrong()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Open_Text').style.display='inline';"/>    </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_40_448_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      StorePilot();
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_129_382_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> Even completely identical Pilot object
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> won't work for update of the saved pilot</span><span style="color: #008000;">
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        pilot.AddPoints(</span><span style="color: #800080;">11</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Set(pilot);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Added 11 points to {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilotWrong_502_56_398_420_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Close();
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      RetrieveAllPilots();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div> </p><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.cs: <span class="fscMemberName">UpdatePilot</span></span></div><div class="fscCode"><pre ID="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilot()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Open_Text').style.display='inline';"/>    </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_35_453_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      StorePilot();
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_124_387_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #800080;">10</span><span style="color: #000000;">));
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Pilot found</span><span style="color: #000000;">=</span><span style="color: #000000;">(Pilot)result.Next();
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        found.AddPoints(</span><span style="color: #800080;">11</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Set(found);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Added 11 points to {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, found);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_UpdatePilot_563_51_403_425_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Close();
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      RetrieveAllPilots();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div></span> </p><p><span class="vb"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.vb: <span class="fscMemberName">StorePilot</span></span></div><div class="fscCode"><pre ID="QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Open_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Closed_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Closed_Text').style.display='inline';"/><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Closed_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Open_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub StorePilot()</span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_StorePilot_646_51_14_601_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> StorePilot()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            File.Delete(YapFileName)
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Set(pilot)
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;"> change pilot and resave updated</span><span style="color: #008000;">
</span><span style="color: #008080;">09</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                pilot.AddPoints(</span><span style="color: #800080;">10</span><span style="color: #000000;">)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Set(pilot)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot)
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Close()
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            RetrieveAllPilots()
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.vb: <span class="fscMemberName">UpdatePilotWrong</span></span></div><div class="fscCode"><pre ID="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Open_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Closed_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Closed_Text').style.display='inline';"/><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Closed_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Open_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotWrong()</span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilotWrong_699_56_14_576_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotWrong()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            StorePilot()
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;">Even completely identical Pilot object</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #008000;">'</span><span style="color: #008000;"> won't work for update of the saved pilot</span><span style="color: #008000;">
</span><span style="color: #008080;">07</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">10</span><span style="color: #000000;">)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                pilot.AddPoints(</span><span style="color: #800080;">10</span><span style="color: #000000;">)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Set(pilot)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Stored {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Close()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            RetrieveAllPilots()
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div> </p>


<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.vb: <span class="fscMemberName">UpdatePilot</span></span></div><div class="fscCode"><pre ID="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Open_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Closed_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Closed_Text').style.display='inline';"/><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Closed_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Open_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilot()</span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_UpdatePilot_766_51_14_604_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilot()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            StorePilot()
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;">first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">10</span><span style="color: #000000;">))
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(result(</span><span style="color: #800080;">0</span><span style="color: #000000;">), Pilot)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                pilot.AddPoints(</span><span style="color: #800080;">10</span><span style="color: #000000;">)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Set(pilot)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Added 10 points to {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Close()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            RetrieveAllPilots()
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div></span><br><br>Deletion is just as easy:</p><p><span class="java"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.java: <span class="fscMemberName">deletePilot</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> deletePilot() </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_33_431_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      storePilot();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ObjectContainer db</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4o.openFile(YAPFILENAME);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_115_361_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #008000;">//</span><span style="color: #008000;">       first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        ObjectSet result</span><span style="color: #000000;">=</span><span style="color: #000000;">db.get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Michael Schumacher</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">10</span><span style="color: #000000;">));
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Pilot found</span><span style="color: #000000;">=</span><span style="color: #000000;">(Pilot)result.next();
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.delete(found);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Deleted </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">found);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Open_Text').style.display='inline';"/>        }</span></span><span style="color: #000000;"> </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> </span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsQueryExampleJava_QueryExampleJava_deletePilot_883_52_370_396_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.close();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        retrieveAllPilots();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div></span> </p><p><span class="cs"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.cs: <span class="fscMemberName">DeletePilot</span></span></div><div class="fscCode"><pre ID="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> DeletePilot() 
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Open_Text').style.display='inline';"/>    </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_36_422_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      StorePilot();
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectContainer db</span><span style="color: #000000;">=</span><span style="color: #000000;">Db4oFactory.OpenFile(YapFileName);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">try</span><span style="color: #000000;"> 
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_124_355_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #008000;">//</span><span style="color: #008000;"> first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">        IObjectSet result</span><span style="color: #000000;">=</span><span style="color: #000000;">db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #800080;">10</span><span style="color: #000000;">));
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Pilot found</span><span style="color: #000000;">=</span><span style="color: #000000;">(Pilot)result.Next();
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Delete(found);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Deleted </span><span style="color: #800000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">found);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;"> 
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      </span><span style="color: #0000FF;">finally</span><span style="color: #000000;"> 
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Open_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Closed_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Closed_Text').style.display='inline';"/><img id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Closed_Text').style.display='none'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Open_Image').style.display='inline'; document.getElementById('QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Open_Text').style.display='inline';"/>      </span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesCSZipsQueryExampleCs_QueryExampleCs_DeletePilot_967_48_372_394_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.Close();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      RetrieveAllPilots();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div></span> </p><p><span class="vb"><div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">QueryExample.vb: <span class="fscMemberName">DeletePilot</span></span></div><div class="fscCode"><pre ID="QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Open_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Open_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Closed_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Closed_Text').style.display='inline';"/><img id="QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Closed_Image" src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Closed_Text').style.display='none'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Open_Image').style.display='inline'; document.getElementById('QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub DeletePilot()</span><span id="QueriesVBZipsQueryExampleVb_QueryExampleVb_DeletePilot_1047_48_14_560_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> DeletePilot()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            StorePilot()
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oFactory.OpenFile(YapFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #008000;">'</span><span style="color: #008000;">first retrieve the object from the database</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">10</span><span style="color: #000000;">))
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">CType</span><span style="color: #000000;">(result(</span><span style="color: #800080;">0</span><span style="color: #000000;">), Pilot)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Delete(pilot)
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Deleted {0}</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, pilot)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                db.Close()
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            RetrieveAllPilots()
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div></span> <br><br>The objects are identified by their references in an application cache. You do 
not&nbsp;need to implement any additional identification systems (like primary keys 
in RDBMS).&nbsp;See <a href="Object_Identity/Object_Identity.html" class="wikiLink">Identity chapter</a> &nbsp; for 
details. The uniqueness of an object is defined&nbsp;only by its reference, if you 
will create 2 objects of the same class with exactly the same&nbsp;fields and save 
them to db4o - you will get 2 objects in your database. As you can see&nbsp;from the 
examples an object instance should be retrieved from the database 
before&nbsp;updating or deleting or you can use the newly created object if it was 
stored in the&nbsp;same session. Creating new instance identical to the object in the 
database and&nbsp;saving it will create a new object in the database.<br>Db4o does 
all the "dirty" work of objects transition between your classes and 
persistent&nbsp;state using <a href="../Advanced_Type_Handling/Db4o_Reflection_API/Db4o_Reflection_API.html" class="wikiLink">Reflection</a> . No 
mappings or additional coding is needed from&nbsp;your side. If you will need to 
change your application model for the next version&nbsp;you will also be surprised 
with the simplicity: all the changes are done in one&nbsp;place - your code, and the 
most common operations are done completely automatically&nbsp;(see <a href="../Advanced_Type_Handling/Refactoring_And_Schema_Evolution/Refactoring_and_Schema_Evolution.html" class="wikiLink">Refactoring 
And Schema Evolution</a>&nbsp; chapter&nbsp;for details).&nbsp;</p><style>
.cs{display:none;}
.vb{display:none;}
</style>
</div>
    </div>
    <div id="footer">
					This revision (4) was last Modified 2006-11-11T13:28:11 by Tetyana.
				</div>
  </body>
</html>