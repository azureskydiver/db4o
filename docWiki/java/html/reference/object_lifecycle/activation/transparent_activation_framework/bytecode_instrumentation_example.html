<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Bytecode Instrumentation Example</title>
    <link rel="stylesheet" type="text/css" href="../../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Bytecode Instrumentation Example</h1><div id="TOC"><div id="TOCinner"><span class="TOCtitle">Contents</span><div class="TOCcontents"><ul><li><a href ="#TA Instrumentation In Java&nbsp;">TA Instrumentation In Java&nbsp;</a></li><li><a href ="#TA Instrumentation In .NET&nbsp;">TA Instrumentation In .NET&nbsp;</a></li></ul></li></ul></div></div></div>As it was mentioned
<a href="ta_implementation.html" class="wikiLink">before</a> you can inject TA awareness in your persistent classes without modifying their original
code. In the current scenario this means: 

<ul><li>generate
the <code>Activatable</code> interface declaration;</li><li>add
<code>bind(objectContainer)</code> method implementation;</li><li>generate
a field to keep a reference to the corresponding <code>Activator</code>
instance;</li><li>generate
<code>activate()</code> call at the beginning of every method.</li></ul>







<span name="cs_wiki_filter" csw_filters="java"><a name="TA Instrumentation In Java&nbsp;"></a><h2>TA Instrumentation In Java&nbsp;</h2><p>TA can be enabled by bytecode injection of the above-mentioned code into the persistent classes when they are
loaded or built. (Currently persistent classes have to be "tagged" by providing
an appropriate <code>ClassFilter</code> instance.) In addition to this db4o
also explicitly needs to be configured to use the Transparent Activation instrumentation
of the persistent classes.</p><p>Transparent Activation functionality requires the following jars:</p><ul><li>bloat-1.0.jar</li><li>db4o-x.x-tools.jar<br></li><li>db4o-x.x-taj.jar <br></li></ul><p>The following topics discuss 2 different ways to enable TA awareness in the persistent classes:</p><ul><li><a href="bytecode_instrumentation_example/ta_instrumentation_at_loading_time.html" class="wikiLink">TA Instrumentation At Loading Time</a> <br></li><li><a href="bytecode_instrumentation_example/ta_instrumentation_at_build_time.html" class="wikiLink">TA Instrumentation At Build Time</a><br></li></ul></span>



<a name="TA Instrumentation In .NET&nbsp;"></a><h2>TA Instrumentation In .NET&nbsp;<br></h2><p>In .NET version this can be accomplished by applying
Db4oAdmin tool to the ready .NET assemblies:</p>

<p><code>Db4oAdmin -ta assembly</code></p>

<p>Let's look at a simple example. We will use SensorPanel
class from <a href="../../activation.html" class="wikiLink">Activation</a> example: </p>





<p>In your code you will need to add Transparent Activation
support to the configuration:</p>





<p>When the assembly is compiled you can use the following
command-line to enable TA support:</p>

<p><code>Db4oAdmin -ta TAExamples.exe</code></p>

<p>use -vv option for verbose output:</p>

<p><code>Db4oAdmin -ta -vv TAExamples.exe</code></p>

<p>You can also apply type filter to TA enable only selected
types:</p>

<p><code>Db4oAdmin.exe -vv -ta -by-name:S* TAExamples.exe</code></p>











<p>Db4oAdmin uses .NET regex to parse the -by-name parameter,
in the example above all types starting with "S" will be TA enabled.</p></div>
    </div>
    <div id="footer">
					This revision (13) was last Modified 2007-10-28T18:00:37 by Tetyana.
				</div>
  </body>
</html>