<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Native Queries</title>
    <link rel="stylesheet" type="text/css" href="../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Native Queries</h1><div id="TOC"><div id="TOCinner"><span class="TOCtitle">Contents</span><div class="TOCcontents"><ul><li><a href ="#Concept">Concept</a></li><li><a href ="#Principle">Principle</a></li><li><a href ="#Simple Example">Simple Example</a></li><li><a href ="#Advanced Example">Advanced Example</a></li><li><a href ="#Arbitrary Code">Arbitrary Code</a></li><li><a href ="#Native Query Performance">Native Query Performance</a></li></ul></li></ul></div></div></div><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>
<p></p>

<p>Wouldn't it be nice to pose queries in the programming language that you are 
using? Wouldn't it be nice if all your query code was 100% typesafe, 100% 
compile-time checked and 100% refactorable? Wouldn't it be nice if the full 
power of object-orientation could be used by calling methods from within 
queries? Enter Native Queries. </p>

<p>Native queries are the main db4o query 
interface and they are the recommended way to query databases from your 
application. Because native queries simply use the semantics of your programming 
language, they are perfectly standardized and a safe choice for the 
future.</p>
<p>Native Queries are available for all platforms supported by 
db4o.</p>
<a name="Concept"></a><h2>Concept</h2>
<p>The concept of native queries is taken from the following two papers:<br><br></p>
<ul>
<li><a href="http://www.cs.utexas.edu/users/wcook/papers/NativeQueries/NativeQueries8-23-05.pdf" target="_blank">Cook/Rosenberger, Native Queries for Persistent Objects, A Design 
White Paper</a></li>
<li><a href="http://www.cs.utexas.edu/~wcook/papers/SafeQuery05/SafeQueryFinal.pdf" target="_blank">Cook/Rai, Safe Query Objects: Statically Typed Objects as Remotely 
Executable Queries</a></li>
</ul>
<a name="Principle"></a><h2>Principle</h2>
<p>Native Queries provide the ability to run one or more lines of code against all 
instances of a class. Native query expressions should return true to mark 
specific instances as part of the result set. db4o will attempt to optimize 
native query expressions and run them against indexes and without instantiating 
actual objects, where this is possible.</p>
<a name="Simple Example"></a><h2>Simple Example</h2>
<p>Let's look at how a simple native query will look like in some of the 
programming languages and dialects that db4o supports:</p>



<span class="java"></p>

<p>Java5:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">PrimitiveExample.java: <span class="fscMemberName">primitiveQuery</span></span></div><div class="fscCode"><pre ID="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> primitiveQuery(ObjectContainer db)</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_53_199_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Open_Text').style.display='inline';"/>    List pilots </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Predicate() </span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_96_194_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Open_Text').style.display='inline';"/>        </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">boolean</span><span style="color: #000000;"> match(Pilot pilot) </span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery_1839_70_138_190_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> pilot.getPoints() </span><span style="color: #000000;">==</span><span style="color: #000000;"> </span><span style="color: #000000;">100</span><span style="color: #000000;">;
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>

<p>Java1.2-1.4:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NQExample.java: <span class="fscMemberName">primitiveQuery</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> primitiveQuery(ObjectContainer db)</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_53_233_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Open_Text').style.display='inline';"/>      List </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> pilots </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Predicate</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">() </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_114_224_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Open_Text').style.display='inline';"/>          </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">boolean</span><span style="color: #000000;"> match(Pilot pilot) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_primitiveQuery_1936_55_159_217_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> pilot.getPoints() </span><span style="color: #000000;">==</span><span style="color: #000000;"> </span><span style="color: #000000;">100</span><span style="color: #000000;">;
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>          }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">);  
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div> </p>

<p>Java1.1:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">PrimitiveExample.java: <span class="fscMemberName">primitiveQuery1</span></span></div><div class="fscCode"><pre ID="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> primitiveQuery1(ObjectContainer db)</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPrimitiveExampleJava_PrimitiveExampleJava_primitiveQuery1_2019_71_54_110_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    List pilots </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> PilotHundredPoints());
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">PilotHundredPoints.java</span></div><div class="fscCode"><pre ID="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Open_Text').style.display='inline';"/><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_0_67_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Copyright (C) 2004 - 2006 db4objects Inc. </span><span style="color: #008000; text-decoration: underline;">http://www.db4o.com</span><span style="color: #008000;"> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">import</span><span style="color: #000000;"> com.db4o.query.Predicate;
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/>
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Open_Text').style.display='inline';"/></span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> PilotHundredPoints </span><span style="color: #0000FF;">extends</span><span style="color: #000000;"> Predicate </span><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_152_242_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Open_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Closed_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Closed_Text').style.display='inline';"/><img id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Closed_Text').style.display='none'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Open_Image').style.display='inline'; document.getElementById('NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">boolean</span><span style="color: #000000;"> match(Pilot pilot) </span><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="NqPrimitiveJavaZipsPilotHundredPointsJava_PilotHundredPointsJava_2094_57_192_240_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> pilot.getPoints() </span><span style="color: #000000;">==</span><span style="color: #000000;"> </span><span style="color: #000000;">100</span><span style="color: #000000;">;
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>

<p></span>



<p>A side note on the above syntax:</p>

<p>For all dialects without support for 
generics, Native Queries work by convention. A class that extends 
the Predicate class is expected to have a boolean #match() or #Match() 
method with one parameter to describe the class extent:</p>

<span class="java"></p>

<p>Java: <code>boolean match(Pilot 
candidate);</code></p>

<p></span>





<p>When using native 
queries, don't forget that modern integrated development environments (IDEs) can 
do all the typing work around the native query expression for you, if you 
use templates and autocompletion.</p>

<span class="java">Here is how to configure a Native Query 
template with Eclipse 3.1:</p>

<p>From the menu, choose Window + Preferences + Java 
+ Editor + Templates + New</p>

<p>As the name type "nq". Make sure that "java" is 
selected as the context on the right. Paste the following into the 
pattern field:</p>

<p><code>List &lt;${extent}&gt; list = db.query(new Predicate &lt;${extent}&gt; () 
{<br>public boolean match(${extent} candidate){<br>return true; 
<br>}<br>}); </code></p>

<p>Now you can create a 
native query with three keys: n + q + Control-Space.</p>

<p>Similar features are 
available in most modern IDEs.</span>
<a name="Advanced Example"></a><h2>Advanced Example</h2>
<p>For complex queries, the native syntax is very precise and quick to write. Let's 
compare to a SODA query that finds all pilots with a given name or a score 
within a given range:</p>

<span class="java"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NQExample.java: <span class="fscMemberName">storePilots</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> storePilots(ObjectContainer db) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_storePilots_3701_56_51_163_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.set(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Michael Schumacher</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">100</span><span style="color: #000000;">));
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        db.set(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Rubens Barrichello</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">,</span><span style="color: #000000;">99</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NQExample.java: <span class="fscMemberName">retrieveComplexSODA</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> retrieveComplexSODA(ObjectContainer db) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveComplexSODA_3761_64_59_449_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Query query</span><span style="color: #000000;">=</span><span style="color: #000000;">db.query();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        query.constrain(Pilot.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        Query pointQuery</span><span style="color: #000000;">=</span><span style="color: #000000;">query.descend(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">points</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        query.descend(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">name</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).constrain(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Rubens Barrichello</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">)
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>          .or(pointQuery.constrain(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Integer(</span><span style="color: #000000;">99</span><span style="color: #000000;">)).greater()
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              .and(pointQuery.constrain(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Integer(</span><span style="color: #000000;">199</span><span style="color: #000000;">)).smaller()));
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        ObjectSet result</span><span style="color: #000000;">=</span><span style="color: #000000;">query.execute();
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        listResult(result);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span>



 </p>

<p>Here is how the same query will look like with native query syntax, fully 
accessible to autocompletion, refactoring and other IDE features, fully checked 
at compile time:</p>

<span class="java"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NQExample.java: <span class="fscMemberName">advancedQuery</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> advancedQuery(ObjectContainer db)</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_52_338_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Open_Text').style.display='inline';"/>      List </span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Predicate</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">() </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_113_329_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Open_Text').style.display='inline';"/>          </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">boolean</span><span style="color: #000000;"> match(Pilot pilot) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_advancedQuery_4068_58_158_322_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>              </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> pilot.getPoints() </span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> </span><span style="color: #000000;">99</span><span style="color: #000000;">
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                  </span><span style="color: #000000;">&amp;&amp;</span><span style="color: #000000;"> pilot.getPoints() </span><span style="color: #000000;">&lt;</span><span style="color: #000000;"> </span><span style="color: #000000;">199</span><span style="color: #000000;">
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                  </span><span style="color: #000000;">||</span><span style="color: #000000;"> pilot.getName().equals(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Rubens Barrichello</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>         }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">);  
</span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span>

  </p>
<a name="Arbitrary Code"></a><h2>Arbitrary Code</h2>
<p>Basically that's all there is to know about native queries to be able to use 
them efficiently. In principle you can run arbitrary code as native queries, you 
just have to be very careful with side effects - especially those that might 
affect persistent objects.</p>

<p>Let's run an example that involves some more 
of the language features available.</p>

<span class="java"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NQExample.java: <span class="fscMemberName">retrieveArbitraryCodeNQ</span></span></div><div class="fscCode"><pre ID="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Open_Text').style.display='inline';"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> retrieveArbitraryCodeNQ(ObjectContainer db) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_63_448_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Open_Text').style.display='inline';"/>      </span><span style="color: #0000FF;">final</span><span style="color: #000000;"> </span><span style="color: #0000FF;">int</span><span style="color: #000000;">[] points</span><span style="color: #000000;">=</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_89_96_Open_Text"><span style="color: #000000;">{</span><span style="color: #000000;">1</span><span style="color: #000000;">,</span><span style="color: #000000;">100</span><span style="color: #000000;">}</span></span><span style="color: #000000;">;
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Open_Text').style.display='inline';"/>        ObjectSet result</span><span style="color: #000000;">=</span><span style="color: #000000;">db.query(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Predicate</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">() </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_155_412_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Open_Text').style.display='inline';"/>          </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">boolean</span><span style="color: #000000;"> match(Pilot pilot) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_200_402_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Open_Text').style.display='inline';"/>            </span><span style="color: #0000FF;">for</span><span style="color: #000000;">(</span><span style="color: #0000FF;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">0</span><span style="color: #000000;">;i</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">points.length;i</span><span style="color: #000000;">++</span><span style="color: #000000;">) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_245_342_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Open_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Closed_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Closed_Text').style.display='inline';"/><img id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Closed_Text').style.display='none'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Open_Image').style.display='inline'; document.getElementById('QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Open_Text').style.display='inline';"/>              </span><span style="color: #0000FF;">if</span><span style="color: #000000;">(pilot.getPoints()</span><span style="color: #000000;">==</span><span style="color: #000000;">points[i]) </span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="QueriesJavaZipsNQExampleJava_NQExampleJava_retrieveArbitraryCodeNQ_4575_68_291_330_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">true</span><span style="color: #000000;">;
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>              }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> pilot.getName().startsWith(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">Rubens</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>      }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>        }</span></span><span style="color: #000000;">);
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        listResult(result);
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span>



 </p>
<a name="Native Query Performance"></a><h2>Native Query Performance</h2>
<p>One drawback of native queries has to be pointed out: Under the hood db4o tries 
to analyze native queries to convert them to SODA. This is not possible for all 
queries. For some queries it is very difficult to analyze the flowgraph. In this 
case db4o will have to instantiate some of the persistent objects to actually 
run the native query code. db4o will try to analyze parts of native query 
expressions to keep object instantiation to the minimum.</p>

<p>The development 
of the native query optimization processor will be an ongoing process in a close 
dialog with the db4o community. Feel free to contribute your results and your 
needs by providing feedback to our <a href="http://developer.db4o.com/forums" target="_blank">db4o forums</a>.</p>

<p>The current state of the query optimization 
process is detailed in the chapter on <a href="../../Db4o_Database_Management/Native_Query_Optimization/Native_Query_Optimization.html" class="wikiLink">Native Query 
Optimization</a></p>

<p>With the current implementation, all above examples will 
run optimized, except for the "Arbitrary Code" example - we are working on 
it.</p></div>
    </div>
    <div id="footer">
					This revision (11) was last Modified 2006-11-14T09:50:12 by Tetyana.
				</div>
  </body>
</html>