<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Updating Structured Objects</title>
    <link rel="stylesheet" type="text/css" href="../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Updating Structured Objects</h1><div id="TOC"><div id="TOCinner"><span class="TOCtitle">Contents</span><div class="TOCcontents"><ul><li><a href ="#Update Depth">Update Depth</a></li></ul></li></ul></div></div></div><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>

<p>To update structured objects in db4o, you simply call set() on them again.</p>



<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdateCar</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdateCar(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdateCar_118_61_52_272_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      Car found </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Car)result.Next();
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      found.Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Somebody else</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      db.Set(found);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ListResult(result);
</span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdateCar</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdateCar()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdateCar_227_61_14_370_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdateCar(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> found </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">DirectCast</span><span style="color: #000000;">(result.[</span><span style="color: #0000FF;">Next</span><span style="color: #000000;">](), Car)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            found.Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Somebody else</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">0</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            db.[</span><span style="color: #0000FF;">Set</span><span style="color: #000000;">](found)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            ListResult(result)
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

<p>Let's modify the pilot, too.</p>



<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSingleSession</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSingleSession(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSingleSession_374_76_67_268_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      Car found </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Car)result.Next();
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      db.Set(found);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ListResult(result);
</span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSingleSession</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSingleSession()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSingleSession_498_76_14_366_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSingleSession(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> found </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">DirectCast</span><span style="color: #000000;">(result.[</span><span style="color: #0000FF;">Next</span><span style="color: #000000;">](), Car)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            db.[</span><span style="color: #0000FF;">Set</span><span style="color: #000000;">](found)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            ListResult(result)
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

<p>Nice and easy, isn't it? But there is something that is not obvious in this example. Let's see what happens if we split this task in two separate db4o sessions: In the first we modify our pilot and update his car:</p>



<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSeparateSessionsPart1</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSeparateSessionsPart1(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart1_845_84_75_213_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      Car found </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Car)result.Next();
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      db.Set(found);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSeparateSessionsPart1</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSeparateSessionsPart1()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart1_977_84_14_293_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSeparateSessionsPart1(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> found </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">DirectCast</span><span style="color: #000000;">(result.[</span><span style="color: #0000FF;">Next</span><span style="color: #000000;">](), Car)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            db.[</span><span style="color: #0000FF;">Set</span><span style="color: #000000;">](found)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

<p>And in the second, we'll double-check our modification:</p>



<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSeparateSessionsPart2</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSeparateSessionsPart2(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsPart2_1174_84_75_154_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ListResult(result);
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSeparateSessionsPart2</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSeparateSessionsPart2()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsPart2_1306_84_14_195_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSeparateSessionsPart2(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            ListResult(result)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

<p>If you will execute this code you will see that Pilot's points are not changed&nbsp;What's happening here and what can we do to fix it?</p>
<a name="Update Depth"></a><h2>Update Depth</h2>
<p>Imagine a complex object with many members that have many members themselves.&nbsp;When updating this object, db4o would have to update all its children,&nbsp;grandchildren, etc. This poses a severe performance penalty and will&nbsp;not be necessary in most cases - sometimes, however, it will.<br><br>So, in our previous update example, we were modifying the Pilot child of a Car&nbsp;object. When we saved the change, we told db4o to save our Car object and assumed&nbsp;that the modified Pilot would be updated. But we were modifying and saving in the&nbsp;same manner as we were in the first update sample, so why did it work before? The&nbsp;first time we made the modification, db4o never actually had to retreive the modified&nbsp;Pilot&nbsp;it returned the same one that was still in memory that we modified, but&nbsp;it never actually updated the database. Restarting the application would show that the value was unchanged.<br><br>To be able to handle this dilemma as flexible as possible, db4o introduces&nbsp;the concept of update depth to control how deep an object's member tree will&nbsp;be traversed on update. The default update depth for all objects is 0, meaning&nbsp;that only primitive and String members will be updated, but changes in object&nbsp;members will not be reflected.<br><br>db4o provides means to control update depth with very fine granularity.&nbsp;For our current problem we'll advise db4o to update the full graph for&nbsp;Car objects by setting cascadeOnUpdate() for this class accordingly.<br><br>

<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart1</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart1(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart1_3144_92_83_176_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      Db4oFactory.Configure().ObjectClass(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Car))
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        .CascadeOnUpdate(</span><span style="color: #0000FF;">true</span><span style="color: #000000;">);        
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart1</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSeparateSessionsImprovedPart1()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart1_3284_92_14_188_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart1(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db4oFactory.Configure().ObjectClass(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Car)).CascadeOnUpdate(</span><span style="color: #0000FF;">True</span><span style="color: #000000;">)
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

&nbsp; </p>

<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart2</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart2(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart2_3434_92_83_221_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      Car found </span><span style="color: #000000;">=</span><span style="color: #000000;"> (Car)result.Next();
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      db.Set(found);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart2</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSeparateSessionsImprovedPart2()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart2_3574_92_14_301_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart2(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> found </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Car </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">DirectCast</span><span style="color: #000000;">(result.[</span><span style="color: #0000FF;">Next</span><span style="color: #000000;">](), Car)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            found.Pilot.AddPoints(</span><span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            db.[</span><span style="color: #0000FF;">Set</span><span style="color: #000000;">](found)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

 </p>

<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.cs: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart3</span></span></div><div class="fscCode"><pre ID="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart3(IObjectContainer db)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Open_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Closed_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Closed_Text').style.display='inline';"/><img id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Closed_Text').style.display='none'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Open_Image').style.display='inline'; document.getElementById('StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Open_Text').style.display='inline';"/>    </span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="StructuredCS.ZipsStructuredExample.Cs_StructuredExample.Cs_UpdatePilotSeparateSessionsImprovedPart3_3718_92_83_162_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      IObjectSet result </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.Get(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      ListResult(result);
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>    }</span></span></div></pre></div></div>

<p></span> </p>

<span class="vb"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">StructuredExample.vb: <span class="fscMemberName">UpdatePilotSeparateSessionsImprovedPart3</span></span></div><div class="fscCode"><pre ID="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Open_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Closed_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Closed_Text').style.display='inline';"/><img id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Closed_Text').style.display='none'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Open_Image').style.display='inline'; document.getElementById('StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub UpdatePilotSeparateSessionsImprovedPart3()</span><span id="StructuredVB.ZipsStructuredExample.Vb_StructuredExample.Vb_UpdatePilotSeparateSessionsImprovedPart3_3858_92_14_203_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> UpdatePilotSeparateSessionsImprovedPart3(</span><span style="color: #0000FF;">ByVal</span><span style="color: #000000;"> db </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer)
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectSet </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.[</span><span style="color: #0000FF;">Get</span><span style="color: #000000;">](</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Car(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Ferrari</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            ListResult(result)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>

<p></span>

<p>You can also achieve expected results using:</p>

<ol>
<li>ExtObjectContainer#set(object, depth) to update exact amount of referenced fields</li>

<li>Use Db4o.configure().objectClass(clazz).updateDepth(depth) setting to define sufficient update depth for a specific object</li>

<li>Use global setting for all the persisted objects:</li>
</ol>



<span class="cs"></p>

<p>c#: <code>Db4oFactory.Configure().UpdateDepth(depth);</code></p>

<p></span> </p>

<span class="vb"></p>

<p>VB: <code>Db4oFactory.Configure().UpdateDepth(depth);</code></p>

<p></span>

<p>However global updateDepth is not flexible enough for real-world objects having different depth of reference structures. </p><p>ATTENTION: Setting global update depth to the maximum value will result in serious performance penalty. Please, use this setting ONLY for debug purposes.<br></p>

<p>Note that container configuration must be set before the container is opened.</p></div>
    </div>
    <div id="footer">
					This revision (7) was last Modified 2007-01-18T19:57:24 by Tetyana.
				</div>
  </body>
</html>