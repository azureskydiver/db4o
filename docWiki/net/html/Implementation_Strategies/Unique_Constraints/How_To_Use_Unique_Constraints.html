<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>How To Use Unique Constraints</title>
    <link rel="stylesheet" type="text/css" href="../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>How To Use Unique Constraints</h1>

<p>In order to work with the unique constraints you will need to remember the
following 3 steps.</p>

<p>1. Add an index for a field you wish to be unique:</p>



<span class="cs"></p>

<p>c#:</p>

<p><code>configuration.ObjectClass(typeof(Item)).ObjectField("field").Indexed(true);</code></p>

<p></span>

<span class="vb"></p>

<p>VB:</p>

<p><code>configuration.ObjectClass(GetType(Item)).ObjectField("field").Indexed(true)</code></p>

<p></span><br>
<br>
2. Configure a unique constraint:<br>


<span class="cs"></p>

<p>c#:</p>

<p><code>configuration.Add(new UniqueFieldValueConstraint(typeof(Item),
"field"));</code></p>

<p></span>

<span class="vb"></p>

<p>VB:</p>

<p><code>configuration.Add(New UniqueFieldValueConstraint(GetType(Item),
"field"))</code></p>

<p></span><br>
<br>
3. Handle unique constraint violation:</p>



<span class="cs"></p>

<p>c#:<br>
<code>// open objectContainer</code><br>
<code>try {</code><br>
<code>&nbsp; //&nbsp;do some work and save some objects</code><br>
<code>&nbsp; objectContainer.Commit();</code><br>
<code>} catch(UniqueFieldValueConstraintViolationException ex) {</code></p>

<p><code>&nbsp; // log the error, notify the
user</code><br>
<code>&nbsp; objectContainer.Rollback();</code><br>
<code>}</code></p>

<p></span>

<span class="vb"></p>

<p>VB:<br>
<code>// open objectContainer</code><br>
<code>Try </code><br>
<code>&nbsp; //&nbsp;do some work and save some objects</code><br>
<code>&nbsp; objectContainer.Commit()</code><br>
<code> Catch ex As
UniqueFieldValueConstraintViolationException </code></p>

<p><code>&nbsp; // log the error, notify the
user</code><br>
<code>&nbsp; objectContainer.Rollback()</code><br>
<code>End Try</code></p>

</span>

</div>
    </div>
    <div id="footer">
					This revision (2) was last Modified 2007-03-25T07:18:49 by Tetyana.
				</div>
  </body>
</html>