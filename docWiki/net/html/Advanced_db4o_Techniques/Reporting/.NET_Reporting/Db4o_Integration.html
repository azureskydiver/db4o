<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Db4o Integration</title>
    <link rel="stylesheet" type="text/css" href="../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Db4o Integration</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>

<p>We will use a separate module to maintain a database
connection and perform db4o operations: <a href="Db4o_Manager.html" class="wikiLink">Db4o Manager</a>. </p>

<p>The following function will add several Pilot objects to the
database:</p>

<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Db4oManager.cs: <span class="fscMemberName">FillUpDb</span></span></div><div class="fscCode"><pre ID="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> FillUpDB()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Open_Text').style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Closed_Image').style.display='inline'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Closed_Text').style.display='inline';"/><img id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Closed_Text').style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Open_Image').style.display='inline'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Open_Text').style.display='inline';"/>        </span><span id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_FillUpDb_234_59_38_309_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">100</span><span style="color: #000000;">);
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db().Set(pilot);
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">David Barichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">95</span><span style="color: #000000;">);
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db().Set(pilot);
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Kimi Raikkonen</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">100</span><span style="color: #000000;">);
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db().Set(pilot);
</span><span style="color: #008080;">9</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

<p></span>

<span class="vb"></p>


<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Db4oManager.vb: <span class="fscMemberName">FillUpDb</span></span></div><div class="fscCode"><pre ID="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Open_Text').style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Closed_Image').style.display='inline'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Closed_Text').style.display='inline';"/><img id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Closed_Text').style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Open_Image').style.display='inline'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub FillUpDB()</span><span id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_FillUpDb_338_59_14_299_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> FillUpDB()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Michael Schumacher</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">100</span><span style="color: #000000;">)
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db.Set(pilot)
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">David Barichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">95</span><span style="color: #000000;">)
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db.Set(pilot)
</span><span style="color: #008080;">6</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Kimi Raikkonen</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">100</span><span style="color: #000000;">)
</span><span style="color: #008080;">7</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            Db.Set(pilot)
</span><span style="color: #008080;">8</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>


<p></span>


<p>Report's data source can accept a single object (Textbox
control) or a list of objects (Table, List, Chart etc.). In this example we use
a table, so a list of objects is needed:</p>

<span class="cs"></p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Db4oManager.cs: <span class="fscMemberName">GetAllPilots</span></span></div><div class="fscCode"><pre ID="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> IList</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> GetAllPilots()
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Open_Text').style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Closed_Image').style.display='inline'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Closed_Text').style.display='inline';"/><img id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Closed_Text').style.display='none'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Open_Image').style.display='inline'; document.getElementById('ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Open_Text').style.display='inline';"/>        </span><span id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ReportsCS.ZipsModulesDb4oManager.Cs_ModulesDb4oManager.Cs_GetAllPilots_634_63_50_156_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IList</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> result </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db().Query</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Pilot</span><span style="color: #000000;">&gt;</span><span style="color: #000000;">(</span><span style="color: #0000FF;">typeof</span><span style="color: #000000;">(Pilot));
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> result;
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>

<p></span>

<span class="vb"></p>


<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Db4oManager.vb: <span class="fscMemberName">GetAllPilots</span></span></div><div class="fscCode"><pre ID="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Open_Text').style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Closed_Image').style.display='inline'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Closed_Text').style.display='inline';"/><img id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Closed_Text').style.display='none'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Open_Image').style.display='inline'; document.getElementById('ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Function GetAllPilots()</span><span id="ReportsVB.ZipsModulesDb4oManager.Vb_ModulesDb4oManager.Vb_GetAllPilots_742_63_14_152_Open_Text"><span style="color: #0000FF;">Function</span><span style="color: #000000;"> GetAllPilots() </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IList
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> result </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IList </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db.Query(</span><span style="color: #0000FF;">GetType</span><span style="color: #000000;">(Pilot))
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Return</span><span style="color: #000000;"> result
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Function</span></span></div></pre></div></div>


<p></span>


<p>This function will return a list of pilot object IDs.
Please, note, that the actual objects will be instantiated only as they are
being retrieved from the list, which means that db4o connection should be kept
open while the report is being created. </p></div>
    </div>
    <div id="footer">
					This revision (2) was last Modified 2007-02-16T19:36:15 by Tetyana.
				</div>
  </body>
</html>