<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>BigMath</title>
    <link rel="stylesheet" type="text/css" href="../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>BigMath</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>
<p>If you are dealing
with very big numbers, you might be using BigDecimal or BigInteger java classes.
These classes are specially designed to allow computations with of arbitrary
precision. Internally the values are stored in byte arrays for both types. Now,
thinking about it - it should not be a problem for db4o to store such values,
as it is just a matter of storing a class with the actual value in a byte array
field. However, a deeper consideration uncovers the following problems:</p>

<ul>
<li>BigInteger/BigDecimal
     representation is different in different java versions, which can cause
     problems re-instantiating the objects from a database created with a
     different Java version. </li>
<li>BigDecimal relies on
     transient field setup in the constructor, which means that constructor use
     is compulsory</li>
<li>db4o would store instances
     of these classes as full object graphs: A BigDecimal contains a BigInteger
     which contains a byte array, plus some other fields. This graph would
     faithfully be persisted into the database file and it would have to be
     read and reconstructed on access - activation depth applies.</li>
<li>Querying and indexing will essentially
     be broken due to the above limitations.</li>
</ul>

<p>To see the problem you can try the following simple
test:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">Probability.java</span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Open_Text').style.display='inline';"/><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">/**/</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_0_75_Open_Text"><span style="color: #008000;">/*</span><span style="color: #008000;"> Copyright (C) 2004 - 2009  Versant Corporation </span><span style="color: #008000; text-decoration: underline;">http://www.versant.com</span><span style="color: #008000;"> </span><span style="color: #008000;">*/</span></span><span style="color: #000000;">
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">package</span><span style="color: #000000;"> com.db4odoc.BigMath;
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/>
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">import</span><span style="color: #000000;"> java.math.</span><span style="color: #000000;">*</span><span style="color: #000000;">;
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/>
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Open_Text').style.display='inline';"/></span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> Probability </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_152_372_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  </span><span style="color: #008000;">//</span><span style="color: #008000;"> Using BigDecimal to represent very small probabilities</span><span style="color: #008000;">
</span><span style="color: #008080;">08</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">  BigDecimal value;
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Probability(String sValue)</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_268_311_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">this</span><span style="color: #000000;">.value </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> BigDecimal(sValue);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> String toString()</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsProbability.Java_Probability.Java_1370_46_339_370_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> value.toString();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">BigMathExample.java: <span class="fscMemberName">testDefaultConfiguration</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> testDefaultConfiguration() </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_47_693_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(DB4O_FILE_NAME).delete();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.openFile(Db4oEmbedded
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        .newConfiguration(), DB4O_FILE_NAME);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Probability p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">2e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">3e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">4e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.close();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.openFile(Db4oEmbedded.newConfiguration(),
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        DB4O_FILE_NAME);
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Query q </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query();
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    q.constrain(Probability.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    q.descend(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">value</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).constrain(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> BigDecimal(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">3e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">)).greater();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    List</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Probability</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.execute();
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">for</span><span style="color: #000000;"> (Probability p : result) </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestDefaultConfiguration_1420_74_645_676_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      System.out.println(p);
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.close();
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div><p>You will see that comparison is not done correctly. However some of the queries can work fine, like unoptimised native queries for example.<br></p>

<p>In order to solve the above mentioned problems db4o
implements special typehandlers for BigInteger and BigDecimal, which allow to
treat them as normal value types, i.e. in the same way as long and double, just
without precision limitation. These typehandlers are implemented in db4o
optional jar (required on the classpath) and should be added to the
configuration before opening the file with the following method:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">BigMathExample.java: <span class="fscMemberName">configBigMathSupport</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">1</span><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> EmbeddedConfiguration configBigMathSupport() </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_ConfigBigMathSupport_2079_70_60_192_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">2</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    EmbeddedConfiguration config </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.newConfiguration();
</span><span style="color: #008080;">3</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    config.common().add(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> BigMathSupport());
</span><span style="color: #008080;">4</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> config;
</span><span style="color: #008080;">5</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div>

<p>Note, that BigMathSupport is a part of common
configuration interface and should be added through common() method.</p>

<p>Now the initial example should produce expected
results:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">BigMathExample.java: <span class="fscMemberName">testBigMathConfiguration</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Open_Text').style.display='inline';"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> testBigMathConfiguration() </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_47_671_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> File(DB4O_FILE_NAME).delete();
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    ObjectContainer db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.openFile(configBigMathSupport(),
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        DB4O_FILE_NAME);
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Probability p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">2e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">3e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    p1 </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Probability(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">4e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.store(p1);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.close();
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.openFile(configBigMathSupport(), DB4O_FILE_NAME);
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Query q </span><span style="color: #000000;">=</span><span style="color: #000000;"> db.query();
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    q.constrain(Probability.</span><span style="color: #0000FF;">class</span><span style="color: #000000;">);
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    q.descend(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">value</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">).constrain(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> BigDecimal(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">3e-324</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">)).greater();
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    List</span><span style="color: #000000;">&lt;</span><span style="color: #000000;">Probability</span><span style="color: #000000;">&gt;</span><span style="color: #000000;"> result </span><span style="color: #000000;">=</span><span style="color: #000000;"> q.execute();
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Open_Text').style.display='inline';"/>    </span><span style="color: #0000FF;">for</span><span style="color: #000000;"> (Probability p : result) </span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesType_HandlingBigMathBigMathJava.ZipsBigMathExample.Java_BigMathExample.Java_TestBigMathConfiguration_2347_74_622_653_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>      System.out.println(p);
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>    }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    db.close();
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>  }</span></span></div></pre></div></div></div>
    </div>
    <div id="footer">
					This revision (2) was last Modified 2009-04-13T18:21:06 by Tetyana.
				</div>
  </body>
</html>