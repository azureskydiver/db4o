<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>NonFlushingStorage</title>
    <link rel="stylesheet" type="text/css" href="../../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>NonFlushingStorage</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script>
<p>NonFlushingStorage is a special IO Storage, which can be used to
improve commit performance. Commit is a complex operation and requires
<a href="../../basic_concepts/acid_model/acid_properties_for_db4o.html" class="wikiLink">flushing
to the hard drive</a> after each stage of commit. This is necessary as
most operating system try to avoid the overhead of disk access by
caching disk write data and only flushing the resulting changes to the
disk. In the case of db4o commit it would mean that the physical write
of some commit stages will be partially skipped and the data will be
irreversibly lost. <br></p><p>However,
physical access to the hard drive is a time-consuming operation and may
considerably affect the performance.&nbsp; That is where
NonFlushingStorage comes in: it allows the operating system to keep
commit data in cache and do the physical writes in a most performant
order. This may sound very nice, but in fact a system shutdown while
the commit data is still in cache will lead to the database corruption.</p>
<p>The following example shows how to use the NonFlushingStorage. You
can run it and see the performance improvement on commit stage:</p>

<span name="cs_wiki_filter" csw_filters="cs">
<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NonFlushingExample.cs: <span class="fscMemberName">TestNonFlushingAdapter</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">static</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> TestNonFlushingAdapter()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Open_Text').style.display='inline';"/>        </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_53_1507_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            File.Delete(Db4oFileName);
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IEmbeddedConfiguration config </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.NewConfiguration();
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.File.Storage </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> NonFlushingStorage(</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> FileStorage());
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            IObjectContainer container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.OpenFile(config, Db4oFileName);
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_375_765_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">99</span><span style="color: #000000;">);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Store(pilot);
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">long</span><span style="color: #000000;"> startTime </span><span style="color: #000000;">=</span><span style="color: #000000;"> DateTime.Now.Ticks;
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Commit();
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Commit time with NonFlushingStorage: </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                        (DateTime.Now.Ticks </span><span style="color: #000000;">-</span><span style="color: #000000;"> startTime)</span><span style="color: #000000;">/</span><span style="color: #000000;">TimeSpan.TicksPerMillisecond </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;"> ms</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">finally</span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_798_848_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close();
</span><span style="color: #008080;">20</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">//
</span><span style="color: #008080;">23</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            File.Delete(Db4oFileName);
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.OpenFile(Db4oEmbedded.NewConfiguration(), Db4oFileName);
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">try</span><span style="color: #000000;">
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1026_1414_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                Pilot pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">99</span><span style="color: #000000;">);
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Store(pilot);
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">long</span><span style="color: #000000;"> startTime </span><span style="color: #000000;">=</span><span style="color: #000000;"> DateTime.Now.Ticks;
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Commit();
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Commit time with default Storage: </span><span style="color: #800000;">&quot;</span><span style="color: #000000;"> </span><span style="color: #000000;">+</span><span style="color: #000000;">
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                        (DateTime.Now.Ticks </span><span style="color: #000000;">-</span><span style="color: #000000;"> startTime)</span><span style="color: #000000;">/</span><span style="color: #000000;"> TimeSpan.TicksPerMillisecond </span><span style="color: #000000;">+</span><span style="color: #000000;"> </span><span style="color: #800000;">&quot;</span><span style="color: #800000;"> ms</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">);
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">34</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">finally</span><span style="color: #000000;">
</span><span style="color: #008080;">35</span><span style="color: #000000;"><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Open_Text').style.display='inline';"/>            </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingCS.ZipsNonFlushingExample.Cs_NonFlushingExample.Cs_TestNonFlushingAdapter_1212_72_1447_1497_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">36</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close();
</span><span style="color: #008080;">37</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>            }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">38</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        }</span></span></div></pre></div></div>&nbsp;</p>
</span>
<span name="cs_wiki_filter" csw_filters="vb">

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">NonFlushingExample.vb: <span class="fscMemberName">TestNonFlushingAdapter</span></span></div><div class="fscCode"><pre ID="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Open_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Open_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Closed_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Closed_Text').style.display='inline';"/><img id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Closed_Image" src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Closed_Text').style.display='none'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Open_Image').style.display='inline'; document.getElementById('ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Open_Text').style.display='inline';"/><span style="color: #0000FF;">Private</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Shared</span><span style="color: #000000;"> </span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">Sub TestNonFlushingAdapter()</span><span id="ResourcesReferenceImplementation_StrategiesStorageNonFlushingStorageNonFlushingVB.ZipsNonFlushingExample.Vb_NonFlushingExample.Vb_TestNonFlushingAdapter_1354_72_15_1491_Open_Text"><span style="color: #0000FF;">Sub</span><span style="color: #000000;"> TestNonFlushingAdapter()
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            File.Delete(Db4oFileName)
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> config </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IEmbeddedConfiguration </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.NewConfiguration()
</span><span style="color: #008080;">06</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            config.File.Storage </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> NonFlushingStorage(</span><span style="color: #0000FF;">New</span><span style="color: #000000;"> FileStorage())
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> container </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> IObjectContainer </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.OpenFile(config, Db4oFileName)
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">99</span><span style="color: #000000;">)
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Store(pilot)
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> startTime </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Long</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> DateTime.Now.Ticks
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Commit()
</span><span style="color: #008080;">13</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #0000FF;">String</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Commit time with NonFlushingStorage: {0} ms</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, _
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    ((DateTime.Now.Ticks </span><span style="color: #000000;">-</span><span style="color: #000000;"> startTime) </span><span style="color: #000000;">/</span><span style="color: #000000;"> TimeSpan.TicksPerMillisecond).ToString()))
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #008000;">'
</span><span style="color: #008080;">20</span><span style="color: #008000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">            File.Delete(Db4oFileName)
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            container </span><span style="color: #000000;">=</span><span style="color: #000000;"> Db4oEmbedded.OpenFile(Db4oEmbedded.NewConfiguration(), Db4oFileName)
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> pilot </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> Pilot </span><span style="color: #000000;">=</span><span style="color: #000000;"> </span><span style="color: #0000FF;">New</span><span style="color: #000000;"> Pilot(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Rubens Barrichello</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, </span><span style="color: #800080;">99</span><span style="color: #000000;">)
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Store(pilot)
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                </span><span style="color: #0000FF;">Dim</span><span style="color: #000000;"> startTime </span><span style="color: #0000FF;">As</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Long</span><span style="color: #000000;"> </span><span style="color: #000000;">=</span><span style="color: #000000;"> DateTime.Now.Ticks
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Commit()
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                System.Console.WriteLine(</span><span style="color: #0000FF;">String</span><span style="color: #000000;">.Format(</span><span style="color: #800000;">&quot;</span><span style="color: #800000;">Commit time with default Storage: {0} ms</span><span style="color: #800000;">&quot;</span><span style="color: #000000;">, _
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                    ((DateTime.Now.Ticks </span><span style="color: #000000;">-</span><span style="color: #000000;"> startTime) </span><span style="color: #000000;">/</span><span style="color: #000000;"> TimeSpan.TicksPerMillisecond).ToString()))
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">Finally</span><span style="color: #000000;">
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>                container.Close()
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>            </span><span style="color: #0000FF;">End</span><span style="color: #000000;"> </span><span style="color: #0000FF;">Try</span><span style="color: #000000;">
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>        </span><span style="color: #0000FF;">End Sub</span></span></div></pre></div></div>&nbsp;</p>

</span>
<p>Please, remember, that NonFlushingStorage is potentially dangerous
and any unexpected system shutdown may corrupt your database. Use with
caution and avoid using in production environments.&nbsp;</p>

</div>
    </div>
    <div id="footer">
					This revision (1) was last Modified 2009-05-09T09:55:48 by Tetyana.
				</div>
  </body>
</html>