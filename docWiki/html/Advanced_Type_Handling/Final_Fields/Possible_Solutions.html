<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Possible Solutions</title>
    <link rel="stylesheet" type="text/css" href="../../style.css">
  </head>
  <body>
    <div class="CommonContent">
      <div class="CommonContentArea">
        <h1>Possible Solutions</h1><script>
//We attach this function to a browser object as a variable so that if multiple of these blocks are
//present on the same page, then they will simply over-write eachother with the same function instead
//of generating a naming collision.
window.WikiCodeFormattingCopyToClipboard = function copyToClipboard(sID){
	var sContent = document.getElementById(sID).innerText;
	if( window.clipboardData && clipboardData.setData )
	{
		clipboardData.setData("Text", sContent);
	}
	else
	{
		alert("You must enable javascript access to your clipboard for this feature to work. Please referr to your browser documentation or Google search for instructions.");
	}
}
</script><p><font color="#990000">This topic applies to java version only</font></p><p>Of course, if you only use JDK5 or 6 there are no worries
about the final fields at all. But if you do not want to stick to the definite
java version and need to have the flexibility of switching to different java
versions you currently have 2 solutions:</p>

<ul><li>avoid using the final modifier in the persistent objects;</li><li>use translator.</li></ul>



<p>An example of the final fields translator can look like
this:</p>

<div class="FormattedSourceCode"><div class="fscHeader"><span class="fscFileName">FinalFieldTranslator.java</span></div><div class="fscCode"><pre ID="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59"><div><!--

Code highlighting produced by Actipro CodeHighlighter (freeware)
http://www.CodeHighlighter.com/

--><span style="color: #008080;">01</span><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/><span style="color: #0000FF;">package</span><span style="color: #000000;"> com.db4odoc.finalfields;
</span><span style="color: #008080;">02</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">import</span><span style="color: #000000;"> com.db4o.</span><span style="color: #000000;">*</span><span style="color: #000000;">;
</span><span style="color: #008080;">03</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">import</span><span style="color: #000000;"> com.db4o.config.</span><span style="color: #000000;">*</span><span style="color: #000000;">;
</span><span style="color: #008080;">04</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/>
</span><span style="color: #008080;">05</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #008000;">//</span><span style="color: #008000;"> Translator allowing to store final fields on any Java version</span><span style="color: #008000;">
</span><span style="color: #008080;">06</span><span style="color: #008000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/None.gif" align="top"/></span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">class</span><span style="color: #000000;"> FinalFieldTranslator    </span><span style="color: #0000FF;">implements</span><span style="color: #000000;"> ObjectConstructor 
</span><span style="color: #008080;">07</span><span style="color: #000000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Open_Text').style.display='inline';"/></span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_211_1166_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">08</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>  
</span><span style="color: #008080;">09</span><span style="color: #000000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Object onStore(ObjectContainer container, Object applicationObject) </span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_292_554_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">10</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">onStore for </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">applicationObject);
</span><span style="color: #008080;">11</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    TestFinal notStorable</span><span style="color: #000000;">=</span><span style="color: #000000;">(TestFinal)applicationObject;
</span><span style="color: #008080;">12</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> final fields values are stored to an array of objects</span><span style="color: #008000;">
</span><span style="color: #008080;">13</span><span style="color: #008000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Open_Text').style.display='inline';"/></span><span style="color: #000000;">    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Object[]</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_492_549_Open_Text"><span style="color: #000000;">{</span><span style="color: #0000FF;">new</span><span style="color: #000000;"> Integer(notStorable._final_i), notStorable._final_s}</span></span><span style="color: #000000;">;
</span><span style="color: #008080;">14</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">15</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">16</span><span style="color: #000000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Object onInstantiate(ObjectContainer container, Object storedObject)</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_633_906_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">17</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">onInstantiate for </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">storedObject);
</span><span style="color: #008080;">18</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    Object[] raw</span><span style="color: #000000;">=</span><span style="color: #000000;">(Object[])storedObject;
</span><span style="color: #008080;">19</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #008000;">//</span><span style="color: #008000;"> final fields values are restored from the array of objects</span><span style="color: #008000;">
</span><span style="color: #008080;">20</span><span style="color: #008000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/></span><span style="color: #000000;">    </span><span style="color: #0000FF;">int</span><span style="color: #000000;"> i</span><span style="color: #000000;">=</span><span style="color: #000000;">((Integer)raw[</span><span style="color: #000000;">0</span><span style="color: #000000;">]).intValue();
</span><span style="color: #008080;">21</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    String s </span><span style="color: #000000;">=</span><span style="color: #000000;"> (String)raw[</span><span style="color: #000000;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;">22</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> </span><span style="color: #0000FF;">new</span><span style="color: #000000;"> TestFinal(i,s);
</span><span style="color: #008080;">23</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">24</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">25</span><span style="color: #000000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> </span><span style="color: #0000FF;">void</span><span style="color: #000000;"> onActivate(ObjectContainer container, Object applicationObject, Object storedObject) </span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1007_1101_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">26</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    System.out.println(</span><span style="color: #000000;">&quot;</span><span style="color: #000000;">onActivate for </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">applicationObject
</span><span style="color: #008080;">27</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>        </span><span style="color: #000000;">+</span><span style="color: #000000;">&quot;</span><span style="color: #000000;"> / </span><span style="color: #000000;">&quot;</span><span style="color: #000000;">+</span><span style="color: #000000;">storedObject);
</span><span style="color: #008080;">28</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">29</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>
</span><span style="color: #008080;">30</span><span style="color: #000000;"><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Open_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Open_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Closed_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Closed_Text').style.display='inline';"/><img id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Closed_Image" src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ContractedSubBlock.gif" align="top" style="display: none;" onClick="this.style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Closed_Text').style.display='none'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Open_Image').style.display='inline'; document.getElementById('FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Open_Text').style.display='inline';"/>  </span><span style="color: #0000FF;">public</span><span style="color: #000000;"> Class storedClass() </span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Closed_Text" style="border: solid 1px #808080; background-color: #FFFFFF; display: none;">...</span><span id="FinalFieldsJava.ZipsFinalFieldTranslator.Java_FinalFieldTranslator.Java_523_59_1132_1164_Open_Text"><span style="color: #000000;">{
</span><span style="color: #008080;">31</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/InBlock.gif" align="top"/>    </span><span style="color: #0000FF;">return</span><span style="color: #000000;"> Object[].</span><span style="color: #0000FF;">class</span><span style="color: #000000;">;
</span><span style="color: #008080;">32</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top"/>  }</span></span><span style="color: #000000;">
</span><span style="color: #008080;">33</span><span style="color: #000000;"><img src="../../Utility/ActiPro.CodeHighligher/OutliningIndicators/ExpandedBlockEnd.gif" align="top"/>}</span></span></div></pre></div></div>

<p>The
following call should be issued before opening the ObjectContainer to connect
the translator to the TestFinal class:</p>

<p><code>Db4o.configure().objectClass(TestFinal.class).translate(new
FinalFieldTranslator());</code></p>



</div>
    </div>
    <div id="footer">
					This revision (3) was last Modified 2007-01-22T19:20:48 by Tetyana.
				</div>
  </body>
</html>